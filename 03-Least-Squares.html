<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to linear regression analysis - 3&nbsp; Least Squares</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04a-Discrete-Distributions.html" rel="next">
<link href="./02-Descriptive-Statistics.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-Least-Squares.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Least Squares</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to linear regression analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General Information</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-Recommended-Literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Recommended reading</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Introduction-to-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Descriptive-Statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-Least-Squares.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Least Squares</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04a-Discrete-Distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Discrete Distributions (Review)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04b-Continuous-Distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Continuous Distributions (Review)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-One-Way-ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">One Way ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-Simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">A Simulation Study</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lecture_problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Задача от лекциите</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#least-squares" id="toc-least-squares" class="nav-link active" data-scroll-target="#least-squares"><span class="header-section-number">3.1</span> Least Squares</a></li>
  <li><a href="#the-one-variable-case-with-an-intercept" id="toc-the-one-variable-case-with-an-intercept" class="nav-link" data-scroll-target="#the-one-variable-case-with-an-intercept"><span class="header-section-number">3.2</span> The one variable case with an intercept</a></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise"><span class="header-section-number">3.3</span> Exercise</a></li>
  <li><a href="#ols-using-the-lm-function-in-r" id="toc-ols-using-the-lm-function-in-r" class="nav-link" data-scroll-target="#ols-using-the-lm-function-in-r"><span class="header-section-number">3.4</span> OLS using the <code>lm</code> function in R</a></li>
  <li><a href="#plot-the-ols-predictions" id="toc-plot-the-ols-predictions" class="nav-link" data-scroll-target="#plot-the-ols-predictions"><span class="header-section-number">3.5</span> Plot the OLS predictions</a></li>
  <li><a href="#interpretation-of-the-ols-coefficients" id="toc-interpretation-of-the-ols-coefficients" class="nav-link" data-scroll-target="#interpretation-of-the-ols-coefficients"><span class="header-section-number">3.6</span> Interpretation of the OLS coefficients</a></li>
  <li><a href="#least-squares-in-matrix-notation" id="toc-least-squares-in-matrix-notation" class="nav-link" data-scroll-target="#least-squares-in-matrix-notation"><span class="header-section-number">3.7</span> Least Squares in Matrix Notation</a></li>
  <li><a href="#the-geometry-of-least-squares" id="toc-the-geometry-of-least-squares" class="nav-link" data-scroll-target="#the-geometry-of-least-squares"><span class="header-section-number">3.8</span> The Geometry of Least Squares</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Least Squares</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The following data set contains information about thirty work days in an accounting company. Every day the company receives invoices from its clients and processes them (e.g.&nbsp;checks them, enters them into the accounting system, etc.). The data set contains the number of invoices processed on each day and the time needed to process them. Our goal is to predict the time needed to process a given number of invoices.</p>
<p>Variables description:</p>
<ul>
<li><code>Day</code> (numeric): day</li>
<li><code>Invoices</code> (numeric): number of invoices</li>
<li><code>Time</code> (numeric): Time needed to process the invoices (hours)</li>
</ul>
<p>Get an overview of the data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>invoices <span class="sc">%&gt;%</span> skimr<span class="sc">::</span><span class="fu">skim</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">Piped data</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Day</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15.50</td>
<td style="text-align: right;">8.80</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">8.25</td>
<td style="text-align: right;">15.5</td>
<td style="text-align: right;">22.75</td>
<td style="text-align: right;">30.0</td>
<td style="text-align: left;">▇▇▇▇▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Invoices</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">130.03</td>
<td style="text-align: right;">74.83</td>
<td style="text-align: right;">23.0</td>
<td style="text-align: right;">62.50</td>
<td style="text-align: right;">127.5</td>
<td style="text-align: right;">189.50</td>
<td style="text-align: right;">289.0</td>
<td style="text-align: left;">▇▅▅▆▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Time</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.11</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2.77</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: left;">▆▇▃▅▂</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>More precisely, our task is to predict the time needed to process 50, 120, 201, 250, 400 invoices.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> invoices, <span class="fu">aes</span>(<span class="at">x =</span> Invoices, <span class="at">y =</span> Time)) <span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">120</span>, <span class="dv">201</span>, <span class="dv">250</span>, <span class="dv">400</span>), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">120</span>, <span class="dv">201</span>, <span class="dv">250</span>, <span class="dv">400</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-invoices-time" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-invoices-time-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-Least-Squares_files/figure-html/fig-invoices-time-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-invoices-time-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Time needed to process the invoices
</figcaption>
</figure>
</div>
</div>
</div>
<p>Let us set up a bit of notation. We have a sample of <span class="math inline">n = 30</span> observations. Let <span class="math inline">i</span> be the number of the days <span class="math inline">i=1,2,\ldots, n</span>. The variable of interest is the time needed to process the invoices, denoted by <span class="math inline">\text{Time}_i</span>. We have one predictor variable, the number of invoices, denoted by <span class="math inline">\text{Invoices}_i</span>.</p>
<p>As our goal is to create predictions, we will denote the predicted time needed to process the invoices by <span class="math inline">\widehat{\text{Time}}_i</span>.</p>
<p>Strategy 1: Use the average processing time for the predictions</p>
<p><span class="math display">
\widehat{\text{Time}}_i^{eq1} = \overline{\text{Time}}
</span></p>
<p>Strategy 2: Use the following linear equation for the predictions</p>
<p><span class="math display">
\widehat{\text{Time}}_i^{eq2} = 0.6 + 0.01 \cdot \text{Invoices}_i
</span></p>
<div id="exr-intercept-only-equation" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.1 (Strategy 1)</strong></span> Compute the predicted time <span class="math inline">\widehat{Time}_i</span> for the first strategy and store it in a new column <code>Time_hat_eq1</code>. Then, compute the residuals (difference between actual and predicted values) and store them in a new column <code>residuals_eq1</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hint: use the mutate function</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>invoices <span class="ot">&lt;-</span> invoices <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">Time_hat_eq1 =</span> <span class="fu">mean</span>(Time),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">residuals_eq1 =</span> Time <span class="sc">-</span> Time_hat_eq1</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="exr-linear-equation" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.2 (Strategy 2)</strong></span> Compute the predicted time <span class="math inline">\widehat{Time}_i</span> for the second strategy and store it in a new column <code>Time_hat_eq2</code>. Then, compute the residuals and store them in a new column <code>residuals_eq2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hint: use the mutate function</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>invoices <span class="ot">&lt;-</span> invoices <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">Time_hat_eq2 =</span> <span class="fl">0.6</span> <span class="sc">+</span> <span class="fl">0.01</span> <span class="sc">*</span> Invoices,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">residuals_eq2 =</span> Time <span class="sc">-</span> Time_hat_eq2</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Before we proceed, let us visualize the residuals of the two strategies.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>invoices <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">Time_hat =</span> <span class="fu">mean</span>(Time),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">residuals =</span> Time <span class="sc">-</span> Time_hat</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Invoices, <span class="at">y =</span> Time)) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(invoices<span class="sc">$</span>Time), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">xend =</span> Invoices,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">yend =</span> <span class="fu">mean</span>(invoices<span class="sc">$</span>Time)), </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(residuals, <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-residuals-strategy-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residuals-strategy-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-Least-Squares_files/figure-html/fig-residuals-strategy-1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residuals-strategy-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Prediction and Residuals for Strategy 1
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>invoices <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">Time_hat =</span> <span class="fl">0.6</span> <span class="sc">+</span> <span class="fl">0.01</span> <span class="sc">*</span> Invoices,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">residuals =</span> Time <span class="sc">-</span> Time_hat</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Invoices, <span class="at">y =</span> Time)) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fl">0.6</span>, <span class="at">slope =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">xend =</span> Invoices,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">yend =</span> Time_hat, </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(residuals, <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-residuals-strategy-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residuals-strategy-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-Least-Squares_files/figure-html/fig-residuals-strategy-2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residuals-strategy-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: Prediction and Residuals for Strategy 2
</figcaption>
</figure>
</div>
</div>
</div>
<p>Which strategy is better? To answer this question we need to agree on a criterion for comparison. The criterion should be a summary of the differences between the actual and the predicted values and should be small when the differences are small. It should also be zero when the predictions are perfect (i.e.&nbsp;no differences between predicted and actual values).</p>
<p>A candidate criterion could be the average residual:</p>
<p><span class="math display">
\frac{1}{n}\sum_{i = 1}^{n} (\text{Time}_i - \widehat{\text{Time}}_i)
</span></p>
<p>It suffers from a major drawback, however. Can you spot it?</p>
<p>A widely used criterion is the mean squared error (MSE) defined as the average of the squared residuals:</p>
<p><span class="math display">
\begin{align*}
\text{RSS} &amp; = \sum_{i=1}^n (\text{Time}_i - \widehat{\text{Time}}_i)^2 \\
\text{MSE} &amp; = \frac{1}{n} \text{RSS}
\end{align*}
</span></p>
<p>where <span class="math inline">\widehat{\text{Time}}_i</span> is the predicted time needed to process the invoices.</p>
<p>Let’s calculate the average prediction error, RSS and MSE for the two strategies. <em>Hint</em>: use the summarize function and the variables holding the residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Strategy 1</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>invoices <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_res_eq1 =</span> <span class="fu">mean</span>(residuals_eq1),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">RSS_eq1 =</span> <span class="fu">sum</span>(residuals_eq1<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">MSE_eq1 =</span> <span class="fu">mean</span>(residuals_eq1<span class="sc">^</span><span class="dv">2</span>),    </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   avg_res_eq1 RSS_eq1   MSE_eq1
1 8.881784e-17  23.747 0.7915667</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Strategy 2</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>invoices <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_res_eq2 =</span> <span class="fu">mean</span>(residuals_eq2),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">RSS_eq2 =</span> <span class="fu">sum</span>(residuals_eq2<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">MSE_eq2 =</span> <span class="fu">mean</span>(residuals_eq2<span class="sc">^</span><span class="dv">2</span>),    </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  avg_res_eq2 RSS_eq2 MSE_eq2
1   0.2096667  4.6347 0.15449</code></pre>
</div>
</div>
<p>Can you guess better values for the coefficients in the linear equation? Try your own values and calculate the RSS and MSE.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your own strategy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="least-squares" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="least-squares"><span class="header-section-number">3.1</span> Least Squares</h2>
<p>The previous discussion leads us to a question. Can we find values for the coefficients in the linear equation that minimize the MSE? The answer is yes. The method is called least squares.</p>
<p>First, let us visualize the MSE as a function of the coefficients. For this purpose, we will simply calculate the MSE for a grid of values of the coefficients and plot the results (<a href="#fig-rss-3d" class="quarto-xref">Figure&nbsp;<span>3.4</span></a>)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: this code here is only for illustration purposes, you don't need to study it or understand it for the course</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a grid of values for beta0_hat and beta1_hat</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>beta0_hat <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.4</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>beta1_hat <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.015</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">beta0_hat =</span> beta0_hat, <span class="at">beta1_hat =</span> beta1_hat) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the RSS for each combination of beta0_hat and beta1_hat</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">RSS =</span> <span class="fu">map2_dbl</span>(beta0_hat, beta1_hat, <span class="sc">~</span>{</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>      Time_hat <span class="ot">&lt;-</span> .x <span class="sc">+</span> .y <span class="sc">*</span> invoices<span class="sc">$</span>Invoices</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>((invoices<span class="sc">$</span>Time <span class="sc">-</span> Time_hat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span>beta0_hat, </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span>beta1_hat, </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">matrix</span>(dt<span class="sc">$</span>RSS, <span class="at">nrow =</span> <span class="fu">length</span>(beta0_hat), <span class="at">ncol =</span> <span class="fu">length</span>(beta1_hat)),</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_surface</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout</span>(</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"beta1_hat"</span>),</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"beta0_hat"</span>),</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"RSS"</span>)</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-rss-3d" class="cell-output-display quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rss-3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="plotly html-widget html-fill-item" id="htmlwidget-05c3d7ae906bb7b48f88" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-05c3d7ae906bb7b48f88">{"x":{"visdat":{"1971415891dc":["function () ","plotlyVisDat"]},"cur_data":"1971415891dc","attrs":{"1971415891dc":{"x":[0.40000000000000002,0.41224489795918368,0.42448979591836739,0.43673469387755104,0.44897959183673469,0.4612244897959184,0.47346938775510206,0.48571428571428577,0.49795918367346942,0.51020408163265307,0.52244897959183678,0.53469387755102038,0.54693877551020409,0.5591836734693878,0.5714285714285714,0.58367346938775511,0.59591836734693882,0.60816326530612241,0.62040816326530612,0.63265306122448983,0.64489795918367343,0.65714285714285714,0.66938775510204085,0.68163265306122445,0.69387755102040816,0.70612244897959187,0.71836734693877546,0.73061224489795917,0.74285714285714288,0.75510204081632648,0.76734693877551019,0.7795918367346939,0.7918367346938775,0.80408163265306121,0.81632653061224492,0.82857142857142851,0.84081632653061222,0.85306122448979593,0.86530612244897953,0.87755102040816324,0.88979591836734695,0.90204081632653066,0.91428571428571426,0.92653061224489797,0.93877551020408168,0.95102040816326527,0.96326530612244898,0.97551020408163269,0.98775510204081629,1],"y":[0.001,0.0012857142857142856,0.0015714285714285713,0.0018571428571428571,0.0021428571428571425,0.0024285714285714284,0.0027142857142857142,0.0029999999999999996,0.0032857142857142855,0.0035714285714285713,0.0038571428571428567,0.0041428571428571426,0.0044285714285714284,0.0047142857142857143,0.0049999999999999992,0.0052857142857142851,0.0055714285714285709,0.0058571428571428568,0.0061428571428571426,0.0064285714285714276,0.0067142857142857134,0.0069999999999999993,0.0072857142857142851,0.007571428571428571,0.0078571428571428577,0.0081428571428571427,0.0084285714285714276,0.0087142857142857126,0.0089999999999999976,0.009285714285714286,0.009571428571428571,0.009857142857142856,0.010142857142857141,0.010428571428571426,0.010714285714285714,0.010999999999999999,0.011285714285714284,0.011571428571428569,0.011857142857142854,0.012142857142857143,0.012428571428571428,0.012714285714285713,0.012999999999999998,0.013285714285714283,0.013571428571428571,0.013857142857142856,0.014142857142857141,0.014428571428571426,0.014714285714285714,0.014999999999999999],"z":[[95.131426999999988,90.709248714285707,86.396397285714272,82.192872714285713,78.098675,74.113804142857134,70.238260142857129,66.472042999999999,62.815152714285709,59.26758928571428,55.829352714285712,52.500442999999997,49.280860142857144,46.170604142857137,43.169675000000005,40.278072714285713,37.495797285714289,34.822848714285712,32.259226999999996,29.804932142857144,27.459964142857142,25.224323000000005,23.098008714285715,21.081021285714286,19.17336071428571,17.375026999999999,15.686020142857146,14.10634014285715,12.635987000000009,11.274960714285712,10.023261285714286,8.8808887142857156,7.8478430000000055,6.9241241428571501,6.1097321428571414,5.4046670000000008,4.8089287142857167,4.3225172857142873,3.9454327142857171,3.6776749999999989,3.5192441428571422,3.4701401428571423,3.5303629999999986,3.6999127142857122,3.978789285714285,4.366992714285713,4.8645229999999966,5.4713801428571376,6.187564142857144,7.0130749999999971],[93.975133289046227,89.580250630154097,85.294694828404829,81.118465883798407,77.051563796334861,73.093988566014161,69.245740192836308,65.506818676801331,61.877224017909199,58.356956216159929,54.94601527155352,51.644401184089965,48.452113953769256,45.369153580591416,42.395520064556436,39.53121340566431,36.776233603915038,34.13058065930862,31.594254571845063,29.167255341524367,26.849582968346525,24.64123745231154,22.542218793419408,20.552526991670138,18.672162047063718,16.901123959600167,15.239412729279469,13.68702835610163,12.243970840066648,10.910240181174506,9.6858363794252398,8.570759434818827,7.5650093473552733,6.6685861170345753,5.881489743856724,5.2037202278217416,4.635277568929614,4.1761617671803437,3.82637282257393,3.5859107351103701,3.4547755047896707,3.4329671316118282,3.5204856155768414,3.7173309566847128,4.0235031549354439,4.4390022103290292,4.9638281228654701,5.5979808925447685,6.3414605193669322,7.1942670033319445],[92.827835829654305,88.460248797584327,84.201988622657211,80.053055304872956,76.013448844231561,72.083169240733014,68.262216494377341,64.550590605164516,60.948291573094536,57.455319398167426,54.071674080383175,50.797355619741772,47.63236401624323,44.576699269887541,41.630361380674721,38.793350348604747,36.065666173677634,33.447308855893375,30.938278395251977,28.53857479175344,26.248198045397753,24.067148156184924,21.995425124114952,20.033028949187837,18.179959631403573,16.43621717076218,14.80180156726364,13.276712820907958,11.860950931695134,10.55451589962515,9.3574077246980405,8.2696264069137868,7.2911719462723887,6.4220443427738489,5.6622435964181559,5.01176970720533,4.4706226751353597,4.0388025002082477,3.7163091824239918,3.5031427217825892,3.3993031182840476,3.404790371928363,3.5196044827155339,3.7437454506455627,4.0772132757184512,4.5200079579341939,5.0721294972927931,5.7335778937942488,6.5043531474385707,7.3844552582257403],[91.689534621824237,87.349243216576411,83.118278668471461,78.996640977509358,74.984330143690116,71.081346167013734,67.2876890474802,63.60335878508954,60.028355379841727,56.562678831736768,53.206329140774677,49.959306306955433,46.82161033027905,43.793241210745514,40.874198948354852,38.064483543107038,35.364094995002084,32.773033304039984,30.291298470220738,27.918890493544357,25.655809374010829,23.502055111620162,21.457627706372346,19.522527158267387,17.696753467305285,15.980306633486046,14.373186656809665,12.875393537276141,11.486927274885474,10.207787869637649,9.037975321532695,7.9774896305705969,7.0263307967513589,6.1844988200749755,5.4519937005414398,4.8288154381507713,4.3149640329029593,3.910439484798002,3.6152417938359038,3.4293709600166586,3.352826983340274,3.3856098638067462,3.5277196014160745,3.7791561961682603,4.139919648063306,4.6100099571012061,5.1894271232819618,5.8781711466055748,6.6762420270720542,7.5836397646813793],[90.560229665556008,86.247233887130363,82.043564965847565,77.949222901707614,73.964207694710538,70.088519344856309,66.322157852144926,62.665123216576426,59.117415438150765,55.679034516867972,52.349980452728033,49.130253245730948,46.019852895876717,43.01877940316534,40.127032767596837,37.344612989171182,34.67152006788838,32.107754003748433,29.653314796751353,27.308202446897127,25.072416954185758,22.945958318617244,20.928826540191587,19.021021618908787,17.222543554768841,15.533392347771761,13.953567997917537,12.483070505206168,11.121899869637661,9.8700560912119908,8.7275391699291962,7.6943491057892563,6.7704858987921748,5.9559495489379479,5.2507400562265705,4.6548574206580593,4.1683016422324037,3.7910727209496056,3.5231706568096643,3.3645954498125774,3.3153470999583501,3.3754256072469802,3.5448309716784654,3.8235631932528089,4.2116222719700129,4.7090082078300703,5.3157210008329834,6.0317606509787538,6.8571271582673905,7.7918205226988748],[89.439920960849634,85.154220809246141,80.977847514785495,76.91080107746771,72.953081497292786,69.104688774260723,65.365622908371506,61.735883899625158,58.215471748021649,54.804386453561008,51.502628016243229,48.310196436068303,45.227091713036238,42.253313847147012,39.388862838400669,36.633738686797173,33.987941392336531,31.451470955018742,29.024327374843814,26.706510651811747,24.498020785922535,22.398857777176179,20.409021625572677,18.528512331112037,16.757329893794246,15.095474313619322,13.542945590587255,12.099743724698046,10.765868715951694,9.5413205643481831,8.4260992698875459,7.4202048325697634,6.5236372523948383,5.7363965293627697,5.0584826634735496,4.4898956547271958,4.0306355031236984,3.6807022086630576,3.4400957713452738,3.3088161911703446,3.2868634681382751,3.3742376022490626,3.5709385935027056,3.8769664418992065,4.2923211474385683,4.8170027101207831,5.4510111299458543,6.1943464069137821,7.0470085410245771,8.0089975322782188],[88.328608507705113,84.070203982923772,79.921126315285292,75.881375504789659,71.950951551436901,68.129854455226976,64.418084216159926,60.81564083423573,57.322524309454387,53.938734641815905,50.664271831320285,47.499135877967511,44.443326781757598,41.496844542690539,38.659689160766348,35.931860635985004,33.31335896834652,30.804184157850894,28.404336204498122,26.113815108288215,23.932620869221157,21.860753487296964,19.898212962515618,18.044999294877133,16.301112484381502,14.666552531028737,13.141319434818827,11.725413195751777,10.418833813827581,9.2215812890462274,8.1336556214077476,7.1550568109121215,6.2857848575593547,5.5258397613494434,4.8752215222823816,4.3339301403581851,3.9019656155768447,3.5793279479383595,3.3660171374427335,3.2620331840899612,3.2673760878800486,3.3820458488129934,3.6060424668887938,3.9393659421074516,4.3820162744689704,4.9339934639733425,5.5952975106205702,6.3659284144106554,7.2458861753436077,8.2351707934194049],[87.226292306122446,82.995183408163257,78.873401367346929,74.860946183673462,70.957817857142857,67.164016387755098,63.479541775510192,59.904394020408162,56.438573122448972,53.082079081632649,49.834911897959181,46.697071571428566,43.668558102040812,40.749371489795912,37.93951173469388,35.238978836734695,32.647772795918364,30.165893612244897,27.793341285714281,25.530115816326532,23.376217204081634,21.331645448979593,19.396400551020406,17.570482510204084,15.853891326530604,14.246626999999998,12.748689530612245,11.36007891836735,10.080795163265314,8.9108382653061167,7.8502082244897942,6.8989050408163273,6.0569287142857169,5.3242792448979639,4.7009566326530594,4.1869608775510194,3.7822919795918373,3.4869499387755112,3.3009347551020416,3.2242464285714276,3.2568849591836728,3.3988503469387745,3.6501425918367323,4.0107616938775479,4.4807076530612244,5.0599804693877539,5.7485801428571399,6.5465066734693824,7.4537600612244921,8.4703403061224485],[86.132972356101618,81.929159084964596,77.83467267097042,73.849513114119105,69.973680414410651,66.207174571845059,62.54999558642232,59.002143458142442,55.56361818700541,52.23441977301124,49.01454821615993,45.904003516451475,42.90278567388588,40.010894688463132,37.228330560183259,34.555093289046233,31.991182875052065,29.53659931820075,27.191342618492293,24.9554127759267,22.828809790503961,20.811533662224075,18.903584391087044,17.104961977092877,15.415666420241561,13.835697720533108,12.365055877967514,11.003740892544776,9.7517527642648965,8.6090914931278579,7.5757570791336928,6.6517495222823833,5.8370688225739293,5.1317149800083337,4.5356879945855866,4.0489878663057057,3.6716145951686796,3.4035681811745109,3.2448486243231991,3.1954559246147434,3.2553900820491455,3.4246510966264054,3.7032389683465201,4.0911536972094931,4.5883952832153279,5.1949637263640147,5.910859026655559,6.7360811840899579,7.6706301986672258,8.7145060703873405],[85.048648657642644,80.872131013327774,76.804940226155765,72.847076296126602,68.998539223240314,65.259329007496873,61.629445648896287,58.108889147438568,54.697659503123695,51.395756715951684,48.203180785922534,45.11993171303623,42.146009497292795,39.281414138692206,36.526145637234485,33.880203992919618,31.343589205747605,28.91630127571845,26.598340202832151,24.389705987088714,22.290398628488131,20.300418127030408,18.419764482715536,16.648437695543521,14.986437765514365,13.43376469262807,11.990418476884633,10.656399118284055,9.4317066168263306,8.3163409725114512,7.3103021853394434,6.4135902553102886,5.6262051824239938,4.9481469666805555,4.3794156080799658,3.9200111066222414,3.5699334623073731,3.3291826751353604,3.1977587451062064,3.1756616722199071,3.2628914564764666,3.4594480978758835,3.765331596418156,4.1805419521032858,4.705079164931278,5.3389432349021222,6.082134162015822,6.9346519462723792,7.8964965876718045,8.9676680862140739],[83.97332121074551,79.824099193252806,75.784204032902949,71.853635729695952,68.032394283631817,64.320479694710528,60.7178919629321,57.22463108829654,53.84069707080382,50.566089910453975,47.400809607246977,44.34485616118284,41.398229572261549,38.560929840483126,35.832956965847565,33.21431094835485,30.704991788005,28.304999484798,26.014334038733857,23.832995449812579,21.760983718034154,19.798298843398584,17.944940825905871,16.200909665556019,14.566205362349013,13.040827916284879,11.624777327363597,10.318053595585177,9.1206567209496114,8.0325867034568876,7.0538435431070372,6.1844272399000424,5.4243377938359041,4.7735752049146223,4.2321394731361917,3.8000305985006242,3.4772485810079137,3.2637934206580592,3.1596651174510622,3.1648636713869212,3.2793890824656384,3.5032413506872122,3.836420476051642,4.2789264585589297,4.8307592982090801,5.4919189950020808,6.2624055489379389,7.1422189600166535,8.131359228238237,9.2298263536026646],[82.906990015410244,78.785063624739692,74.772464091211987,70.869191414827156,67.075245595585173,63.39062663348605,59.815334528529775,56.349369280716374,52.992730890045813,49.745419356518113,46.607434680133281,43.578776860891296,40.659445898792171,37.849441793835901,35.148764546022491,32.557414155351942,30.075390621824244,27.702693945439403,25.439324126197416,23.285281164098297,21.240565059142028,19.305175811328617,17.479113420658059,15.762377887130365,14.15496921074552,12.656887391503542,11.268132429404417,9.9887043244481521,8.8186030766347461,7.7578286859641796,6.8063811524364866,5.9642604760516464,5.2314666568096655,4.6079996947105419,4.0938595897542687,3.689046341940859,3.3935599512703063,3.207400417742607,3.1305677413577673,3.1630619221157845,3.3048829600166578,3.5560308550603907,3.9165056072469766,4.3863072165764212,4.9654356830487307,5.653891006663887,6.4516731874219024,7.3587822253227753,8.3752181203665153,9.5009808725531002],[81.849655071636803,77.755024307788418,73.769720401082878,69.893743351520186,66.127093159100369,62.469769823823405,58.921773345689289,55.48310372469804,52.153760960849645,48.933745054144104,45.823056004581424,42.821693812161598,39.929658476884633,37.146949998750515,34.473568377759271,31.909513613910871,29.454785707205332,27.10938465764265,24.873310465222822,22.746563129945859,20.729142651811745,18.821049030820493,17.022282266972095,15.332842360266556,13.752729310703868,12.281943118284048,10.920483783007082,9.6683513048729761,8.5255456838817238,7.4920669200333174,6.5679150133277808,5.753089963765099,5.0475917713452763,4.4514204360683092,3.9645759579341933,3.587058336942941,3.3188675730945452,3.1600036663890041,3.1104666168263222,3.1702564244064959,3.3393730891295275,3.6178166109954164,4.0055869900041614,4.5026842261557629,5.109108319450228,5.8248592698875443,6.6499370774677171,7.5843417421907455,8.6280732640566438,9.7811316430653861],[80.801316379425231,76.733981242398997,72.77597296251561,68.927291539775084,65.187936974177418,61.557909265722614,58.037208414410657,54.62583442024156,51.323787283215317,48.131067003331943,45.047673580591422,42.073607014993748,39.208867306538934,36.453454455226982,33.807368461057891,31.270609324031653,28.843177044148273,26.525071621407744,24.316293055810075,22.21684134735527,20.226716496043316,18.34591850187422,16.574447364847977,14.912303084964599,13.359485662224067,11.915995096626405,10.581831388171596,9.356994536859645,8.2414845426905519,7.2353014056643019,6.3384451257809236,5.5509157030404008,4.8727131374427346,4.3038374289879249,3.8442885776759668,3.4940665835068714,3.2531714464806334,3.121603166597251,3.099361743856726,3.1864471782590575,3.3828594698042473,3.6885986184922932,4.1036646243231951,4.6280574872969549,5.2617772074135782,6.004823784673051,6.8571972190753812,7.8188975106205678,8.8899246593086243,10.070278665139524],[79.761973938775512,75.72193442857143,71.791221775510209,67.969835979591835,64.257777040816322,60.65504495918367,57.161639734693878,53.777561367346941,50.502809857142857,47.337385204081635,44.281287408163266,41.334516469387758,38.497072387755104,35.768955163265304,33.150164795918371,30.64070128571429,28.240564632653065,25.949754836734694,23.768271897959181,21.696115816326532,19.733286591836741,17.8797842244898,16.135608714285716,14.500760061224492,12.975238265306121,11.559043326530613,10.252175244897963,9.0546340204081677,7.9664196530612337,6.9875321428571402,6.1179714897959201,5.3577376938775521,4.7068307551020432,4.1652506734693917,3.732997448979591,3.4100710816326538,3.1964715714285732,3.092198918367346,3.0972531224489783,3.211634183673469,3.4353421020408139,3.7683768775510194,4.2107385102040773,4.7624269999999935,5.423442346938776,6.1937845510204053,7.0734536122448928,8.0624495306122377,9.1607723061224497,10.368421938775509],[78.731627749687618,74.718883866305703,70.815466840066634,67.021376670970426,63.336613359017072,59.761176904206579,56.295067306538932,52.938284566014161,49.69082868263223,46.552699656393166,43.523897487296956,40.604422175343601,37.794273720533113,35.093452122865465,32.501957382340692,30.019789498958769,27.646948472719703,25.383434303623492,23.229246991670134,21.184386536859645,19.248852939192005,17.422646198667227,15.705766315285299,14.09821328904623,12.599987119950017,11.211087807996668,9.9315153531861746,8.7612697555185388,7.7003510149937595,6.7487591316118261,5.9064941053727624,5.1735559362765526,4.549944624323202,4.035660169512707,3.6307025718450636,3.3350718313202834,3.1487679479383597,3.0717909216992911,3.1041407526030809,3.245817440649728,3.4968209858392316,3.8571513881715926,4.3268086476468088,4.9057927642648833,5.5941037380258214,6.3917415689296098,7.2987062569762546,8.3149978021657542,9.4406162044981272,10.67556146397334],[77.710277812161593,73.724829555601829,69.848708156184912,66.081913613910856,62.424445928779676,58.876305100791335,55.437491129945847,52.108004016243228,48.887843759683456,45.777010360266551,42.775503817992501,39.883324132861304,37.100471304872961,34.426945334027486,31.862746220324865,29.407873963765098,27.062328564348189,24.826110022074133,22.699218336942938,20.6816535089546,18.773415538109123,16.974504424406497,15.28492016784673,13.70466276842982,12.233732226155762,10.872128541024571,9.6198517130362351,8.4769017421907567,7.4432786284881365,6.5189823719283586,5.7040129725114523,4.9983704302374017,4.4020547451062075,3.9150659171178703,3.5374039462723852,3.2690688325697619,3.110060576009996,3.0603791765930857,3.1200246343190328,3.2889969491878372,3.5672961211994991,3.9549221503540171,4.4518750366513915,5.0581547800916224,5.7737613806747188,6.5986948384006645,7.5329551532694667,8.5765423252811264,9.7294563544356532,10.991697240733027],[76.697924126197421,72.739771496459809,68.890945723865059,65.151446808413155,61.521274750104119,58.000429548937944,54.588911204914616,51.286719718034156,48.093855088296543,45.010317315701791,42.036106400249899,39.171222341940862,36.415665140774678,33.769434796751348,31.23253130987089,28.804954680133282,26.486704907538527,24.277781992086634,22.178185933777591,20.187916732611416,18.306974388588092,16.535358901707625,14.873070271970013,13.320108499375262,11.876473583923364,10.54216552561433,9.3171843244481494,8.2015299804248265,7.1952024935443646,6.298201863806745,5.510528091211996,4.832181175760101,4.2631611174510642,3.8034679162848843,3.453101572261557,3.2120620853810919,3.0803494556434829,3.0579636830487282,3.1449047675968327,3.3411727092877959,3.6467675081216133,4.0616891640982908,4.5859376772178209,5.2195130474802092,5.9624152748854655,6.8146443594335651,7.7762003011245255,8.8470830999583434,10.027292755935028,11.316829269054558],[75.694566691795075,71.763709688879629,67.942179543107031,64.229976254477293,60.627099822990417,57.133550248646394,53.749327531445225,50.474431671386924,47.30886266847147,44.252620522698869,41.305705234069137,38.468116802582252,35.739855228238234,33.120920511037063,30.611312650978761,28.211031648063308,25.920077502290713,23.738450213660975,21.666149782174092,19.703176207830072,17.849529490628907,16.105209630570599,14.470216627655144,12.944550481882548,11.528211193252808,10.22119876176593,9.0235131874219103,7.9351544702207457,6.9561226101624385,6.0864176072469789,5.3260394614743864,4.6749881728446487,4.1332637413577702,3.7008661670137473,3.3777954498125773,3.1640515897542691,3.0596345868388175,3.064544441066221,3.1787811524364824,3.4023447209496029,3.7352351466055786,4.1774524294044113,4.7289965693461005,5.389867566430647,6.1600654206580581,7.0395901320283185,8.0284417005414355,9.1266201261974071,10.334125408996254,11.650957548937939],[74.700205508954596,70.796644132861303,67.002409613910856,63.317501952103278,59.741921147438568,56.275667199916697,52.918740109537687,49.671139876301538,46.532866500208243,43.503919981257802,40.584300319450229,37.774007514785502,35.073041567263637,32.481402476884625,29.999090243648482,27.626104867555185,25.362446348604749,23.208114686797167,21.163109882132442,19.227431934610578,17.401080844231572,15.68405661099542,14.076359234902123,12.577988715951687,11.188945054144101,9.9092282494793817,8.738838301957518,7.6777752115785116,6.7260389783423626,5.8836296022490586,5.1505470832986244,4.5267914214910459,4.0123626168263238,3.6072606693044582,3.3114855789254465,3.1250373456892957,3.0479159695960014,3.0801214506455632,3.2216537888379824,3.4725129841732603,3.8326990366513938,4.3022119462723847,4.8810517130362303,5.5692183369429333,6.3667118179925035,7.2735321561849213,8.2896793515201956,9.4151534039983265,10.649954313619329,11.994082080383173],[73.714840577675972,69.83857482840483,66.07163593627655,62.414023901291131,58.865738723448558,55.426780402748854,52.097148939192003,48.876844332778013,45.76586658350687,42.764215691378588,39.871891656393174,37.088894478550607,34.415224157850901,31.850880694294041,29.395864087880053,27.050174338608915,24.813811446480635,22.686775411495212,20.669066233652643,18.760683912952938,16.961628449396091,15.271899842982092,13.691498093710955,12.220423201582676,10.85867516659725,9.6062539887546876,8.4631596680549794,7.4293922044981295,6.5049515980841397,5.689837848812993,4.9840509566847162,4.3875909216992923,3.9004577438567276,3.5226514231570203,3.2541719596001659,3.0950193531861729,3.045193603915036,3.1046947117867534,3.2735226768013299,3.5516774989587661,3.9391591782590556,4.4359677147022056,5.0421031082882068,5.7575653590170681,6.5823544668887974,7.5164704319033699,8.5599132540608025,9.7126829333610907,10.974779469804249,12.34620286339025],[72.738471897959187,68.889501775510197,65.149858510204083,61.519542102040809,57.99855255102041,54.58688985714285,51.284554020408159,48.091545040816328,45.007862918367344,42.033507653061221,39.168479244897959,36.412777693877551,33.766402999999997,31.2293551632653,28.801634183673471,26.483240061224489,24.274172795918368,22.174432387755104,20.18401883673469,18.302932142857145,16.53117230612245,14.868739326530616,13.315633204081633,11.87185393877551,10.537401530612241,9.3122759795918366,8.1964772857142876,7.1900054489795968,6.2928604693877608,5.5050423469387741,4.8265510816326538,4.2573866734693881,3.7975491224489817,3.4470384285714308,3.2058545918367338,3.0739976122448978,3.0514674897959182,3.1382642244897938,3.3343878163265277,3.6398382653061212,4.0546155714285685,4.5787197346938742,5.2121507551020345,5.9549086326530531,6.8069933673469372,7.7684049591836706,8.8391434081632596,10.019208714285703,11.308600877551022,12.707319897959179],[71.771099469804241,67.949424974177418,64.237077335693456,60.634056554352348,57.140362630154101,53.755995563098708,50.480955353186168,47.31524200041649,44.258855504789665,41.311795866305701,38.474063084964598,35.745657160766342,33.126578093710947,30.616825883798413,28.216400531028739,25.925302035401916,23.743530396917951,21.671085615576843,19.707967691378588,17.854176624323198,16.109712414410666,14.474575061640984,12.948764566014159,11.532280927530197,10.225124146189081,9.0272942219908359,7.9387911549354433,6.9596149450229099,6.089765592253233,5.3292430966264019,4.6780474581424398,4.1361786768013333,3.7036367526030833,3.3804216855476898,3.1665334756351511,3.0619721228654719,3.0667376272386502,3.180829988754684,3.4042492074135748,3.7369952832153261,4.1790682161599317,4.7304680062473947,5.3911946534777124,6.1612481578508875,7.0406285193669307,8.0293357380258215,9.127369813827567,10.334730746772172,11.651418536859644,13.07743318408996],[70.812723293211164,67.018344424406493,63.33329241274469,59.757567258225741,56.291168960849646,52.934097520616412,49.686352937526031,46.547935211578512,43.518844342773846,40.599080331112035,37.788643176593091,35.087532879216994,32.495749438983758,30.013292855893376,27.640163129945858,25.376360261141194,23.221884249479384,21.176735094960435,19.24091279758434,17.414417357351105,15.697248774260729,14.089407048313205,12.590892179508538,11.201704167846733,9.9218430133277788,8.7513087159516889,7.6901012757184519,6.738220692628075,5.8956669666805563,5.1624400978758835,4.5385400862140788,4.023966931695127,3.6187206343190348,3.3228011940857991,3.1362086109954177,3.0589428850478972,3.0910040162432324,3.2323920045814214,3.48310685006247,3.8431485526863791,4.3125171124531407,4.8912125293627629,5.579234803415237,6.3765839346105695,7.2832599229487718,8.2992627684298164,9.424592471053721,10.659249030820483,12.003232447730113,13.456542721782586],[69.863343368179926,66.096260126197407,62.438503741357771,58.890074213660967,55.450971543107038,52.121195729695955,48.900746773427734,45.789624674302374,42.787829432319867,39.895361047480215,37.112219519783423,34.438404849229485,31.873917035818408,29.418756079550185,27.072921980424827,24.836414738442315,22.709234353602668,20.691380825905874,18.782854155351934,16.983654341940859,15.293781385672638,13.713235286547276,12.242016044564766,10.880123659725115,9.6275581320283177,8.4843194614743851,7.450407648063309,6.5258226917950894,5.7105645926697264,5.0046333506872127,4.4080289658475635,3.9207514381507709,3.5428007675968365,3.2741769541857573,3.1148799979175337,3.0649098987921697,3.1242666568096622,3.2929502719700099,3.5709607442732154,3.9582980737192823,4.4549622603082017,5.0609533040399795,5.7762712049146119,6.6009159629321026,7.5348875780924596,8.5781860503956651,9.7308113798417253,10.992763566430643,12.364042610162434,13.844648511037065],[68.922959694710528,65.183172079550175,61.552711321532691,58.031577420658053,54.619770376926276,51.31729019033736,48.124136860891291,45.040310388588082,42.065810773427735,39.200638015410242,36.444792114535609,33.79827307080383,31.261080884214905,28.833215554768842,26.514677082465639,24.305465467305289,22.205580709287798,20.21502280841316,18.333791764681379,16.56188757809246,14.899310248646399,13.346059776343191,11.902136161182838,10.567539403165348,9.3422695022907067,8.2263264585589333,7.2197102719700128,6.3224209425239506,5.5344584702207458,4.8558228550603886,4.2865140970428977,3.8265321961682632,3.4758771524364858,3.2345489658475639,3.1025476364014986,3.0798731640982915,3.1665255489379418,3.3625047909204477,3.6678108900458111,4.0824438463140353,4.606403659725113,5.2396903302790472,5.9823038579758379,6.834244242815485,7.7955114847980012,8.866105583923364,10.046026540191582,11.335274353602657,12.733849024156605,14.241750551853393],[67.991572272802998,64.279080284464811,60.675915153269472,57.182076879216993,53.797565462307375,50.522380902540611,47.356523199916701,44.299992354435652,41.352788366097457,38.514911234902122,35.786360960849649,33.167137543940029,30.657240984173264,28.256671281549352,25.965428436068308,23.783512447730114,21.710923316534778,19.747661042482303,17.893725625572678,16.149117065805918,14.513835363182011,12.98788051770096,11.571252529362766,10.263951398167432,9.0659771241149514,7.9773297072053326,6.9980091474385686,6.1280154448146638,5.3673485993336172,4.7160086109954165,4.1739954798000847,3.7413092057476049,3.4179497888379848,3.2039172290712212,3.0992115264473128,3.1038326809662644,3.2177806926280716,3.4410555614327327,3.7736572873802534,4.2155858704706359,4.7668413107038692,5.4274236080799643,6.1973327625989096,7.0765687742607142,8.0651316430653903,9.1630213690129061,10.370237952103283,11.686781392336517,13.112651689712621,14.647848844231566],[67.069181102457307,63.383984740941273,59.808115236568092,56.341572589337773,52.984356799250314,49.736467866305702,46.597905790503951,43.568670571845061,40.648762210329025,37.83818070595585,35.136926058725528,32.544998268638068,30.062397335693461,27.689123259891709,25.425176041232824,23.270555679716786,21.225262175343609,19.289295528113286,17.46265573802582,15.745342805081219,14.137356729279468,12.638697510620577,11.249365149104541,9.9693596447313624,8.7986809975010392,7.7373292074135778,6.7853042744689729,5.9426061986672263,5.2092349800083344,4.5851906184922937,4.0704731141191175,3.6650824668887965,3.3690186768013342,3.182281743856727,3.1048716680549764,3.1367884493960845,3.2780320878800491,3.5286025835068688,3.8884999362765469,4.3577241461890859,4.9362752132444783,5.6241531374427272,6.4213579187838326,7.3278895572677953,8.3437480528946253,9.4689334056643037,10.703445615576836,12.047284682632224,13.500450606830489,15.062943388171592],[66.155786183673456,62.497885448979588,58.949311571428566,55.510064551020399,52.180144387755099,48.959551081632647,45.848284632653055,42.846345040816324,39.953732306122447,37.170446428571424,34.496487408163269,31.931855244897957,29.476549938775506,27.130571489795912,24.893919897959186,22.766595163265308,20.748597285714286,18.839926265306122,17.040582102040812,15.350564795918366,13.769874346938778,12.298510755102042,10.936474020408163,9.683764142857143,8.5403811224489754,7.5063249591836732,6.5815956530612238,5.7661932040816346,5.0601176122449019,4.4633688775510176,3.9759469999999992,3.5978519795918369,3.3290838163265311,3.1696425102040817,3.1195280612244893,3.1787404693877543,3.3472797346938767,3.6251458571428548,4.0123388367346902,4.508858673469387,5.1147053673469367,5.8298789183673438,6.6543793265306057,7.5882065918367259,8.6313607142857141,9.7838416938775499,11.04564953061224,12.416784224489788,13.897245775510207,15.487034183673467],[65.251387516451473,61.620782408579757,58.099504157850895,54.687552764264886,51.384928227821739,48.191630548521452,45.107659726364012,42.133015761349441,39.267698653477716,36.511708402748852,33.865045009162849,31.327708472719703,28.899698793419411,26.581015971261973,24.371660006247399,22.27163089837568,20.280928647646814,18.399553254060809,16.627504717617658,14.964783038317371,13.411388216159938,11.967320251145358,10.632579143273636,9.4071648925447757,8.2910774989587672,7.2843169625156197,6.3868832832153286,5.5987764610578958,4.9199964960433205,4.3505433881715936,3.890417137442733,3.5396177438567258,3.2981452074135778,3.1659995281132862,3.1431807059558508,3.2296887409412744,3.4255236330695538,3.7306853823406878,4.1451739887546797,4.6689894523115347,5.3021317730112409,6.0446009508538072,6.8963969858392247,7.8575198779675022,8.9279696272386513,10.107746233652639,11.396849697209488,12.795280017909194,14.30303719575177,15.920121230737189],[64.35598510079133,60.752675619741773,57.258692995835069,53.874037229071213,50.598708319450232,47.43270626697209,44.37603107163681,41.428682733444397,38.590661252394831,35.861966628488126,33.242598861724282,30.732557952103289,28.331843899625156,26.040456704289877,23.858396366097463,21.785662885047898,19.822256261141192,17.968176494377342,16.22342358475635,14.587997532278219,13.061898336942942,11.645125998750524,10.337680517700958,9.1395618937942515,8.0507701270304004,7.0713052174094129,6.2011671649312801,5.4403559695960055,4.7888716314035857,4.246714150354018,3.8138835264473139,3.4903797596834649,3.2762028500624747,3.1713527975843396,3.175829602249062,3.2896332640566421,3.5127637830070788,3.8452211591003711,4.2870053923365203,4.8381164827155336,5.4985544302373972,6.2683192349021191,7.1474108967096956,8.1358294156601314,9.2335747917534334,10.440647024989584,11.757046115368588,13.182772062890448,14.717824867555187,16.36220452936276],[63.46957893669304,59.893565082465635,56.426878085381084,53.069517945439394,49.821484662640565,46.682778236984589,43.653398668471468,40.733345957101207,37.9226201028738,35.221221105789247,32.629148965847563,30.146403683048728,27.772985257392751,25.508893688879628,23.354128977509372,21.308691123281967,19.37258012619742,17.545795986255726,15.828338703456891,14.220208277800914,12.721404709287798,11.331927997917534,10.051778143690129,8.8809551466055812,7.8194590066638856,6.8672897238650554,6.0244472982090791,5.2909317296959619,4.6667430183257013,4.15188116409829,3.7463461670137432,3.4501380270720534,3.2632567442732197,3.1857023186172424,3.217474750104123,3.3585740387338601,3.6090001845064541,3.9687531874219046,4.4378330474802121,5.0162397646813819,5.7039733390254037,6.5010337705122829,7.4074210591420178,8.42313520491461,9.5481762078300711,10.782544067888379,12.126238785089539,13.579260359433558,15.141608790920452,16.813284079550186],[62.592169024156597,59.043450796751351,55.604059426488959,52.273994913369428,49.053257257392751,45.941846458558935,42.939762516867972,40.047005432319871,37.263575204914616,34.58947183465223,32.024695321532697,29.569245665556021,27.2231228667222,24.986326925031236,22.858857840483136,20.840715613077887,18.931900242815495,17.132411729695963,15.442250073719283,13.861415274885468,12.389907333194506,11.027726248646399,9.7748720212411495,8.631344650978761,7.5971441378592255,6.67227048188255,5.856723683048731,5.1505037413577703,4.553610656809667,4.0660444294044131,3.6878050591420246,3.4188925460224899,3.259306890045814,3.2090480912119941,3.268116149521032,3.4365110649729274,3.7142328375676787,4.1012814673052853,4.5976569541857488,5.2033592982090777,5.9183884993752551,6.7427445576842944,7.6764274731361839,8.7194372457309335,9.8717738754685556,11.133437362349015,12.504427706372336,13.984744907538515,15.574388965847563,17.273359881299456],[61.723755363182001,58.202332762598914,54.790237019158681,51.487468132861302,48.294026103706791,45.209910931695127,42.235122616826317,39.369661159100374,36.613526558517286,33.966718815077051,31.429237928779674,29.001083899625154,26.682256727613495,24.472756412744687,22.372582955018746,20.381736354435652,18.50021661099542,16.728023724698044,15.065157695543521,13.511618523531864,12.067406208663058,10.732520750937113,9.5069621503540205,8.3907304069137858,7.3838255206164067,6.4862474914618904,5.6979963194502306,5.0190720045814281,4.4494745468554804,3.9892039462723856,3.6382602028321531,3.3966433165347767,3.2643532873802581,3.2413901153685951,3.3277538004997909,3.5234443427738431,3.8284617421907523,4.2428059987505158,4.7664771124531375,5.3994750832986238,6.1417999112869595,6.9934515964181534,7.9544301386922021,9.024735538109109,10.204367794668885,11.493326908371507,12.891612879216984,14.399225707205318,16.016165392336529,17.742431934610575],[60.864337953769258,57.370210980008324,53.98541086339025,50.70993760391503,47.543791201582671,44.486971656393166,41.539478968346515,38.701313137442732,35.972474163681795,33.35296204706372,30.842776787588505,28.441918385256141,26.150386840066634,23.968182152019988,21.895304321116203,19.931753347355272,18.077529230737195,16.332631971261975,14.697061568929611,13.170818023740107,11.753901335693463,10.446311504789671,9.2480485310287381,8.1591124144106626,7.1795031549354391,6.3092207526030819,5.5482652074135776,4.8966365193669317,4.3543346884631431,3.9213597147022048,3.597711598084131,3.3833903386089128,3.2783959362765511,3.2827283910870459,3.3963877030403995,3.6193738721366087,3.9516868983756752,4.3933267817575974,4.9442935222823765,5.6045871199500201,6.374207574760514,7.2531548867138653,8.2414290558100713,9.3390300820491348,10.54595796543107,11.862212705955848,13.287794303623484,14.822702758433977,16.466938070387343,18.220500239483545],[60.013916795918369,56.547085448979594,53.189580959183672,49.941403326530612,46.802552551020405,43.773028632653059,40.852831571428574,38.041961367346943,35.340418020408165,32.748201530612242,30.265311897959187,27.891749122448982,25.627513204081634,23.47260414285714,21.427021938775511,19.490766591836739,17.663838102040817,15.946236469387758,14.337961693877551,12.839013775510207,11.449392714285718,10.169098510204083,8.998131163265306,7.9364906734693887,6.9841770408163262,6.1411902653061228,5.4075303469387759,4.7831972857142873,4.2681910816326569,3.862511734693876,3.56615924489796,3.3791336122448965,3.3014348367346931,3.3330629183673453,3.4740178571428562,3.7242996530612236,4.0839083061224466,4.5528438163265257,5.1311061836734613,5.8186954081632631,6.6156114897959135,7.5218544285714239,8.5374242244897864,9.6623208775510072,10.896544387755103,12.240094755102033,13.692971979591828,15.255176061224477,16.926707,18.707564795918362],[59.17249188962932,55.732956169512697,52.402747306538942,49.181865300708033,46.070310152019992,43.068081860474798,40.175180426072465,37.391605848812993,34.717358128696375,32.152437265722611,29.696843259891711,27.350576111203662,25.113635819658477,22.986022385256142,20.967735807996672,19.058776087880052,17.259143224906293,15.568837219075386,13.987858070387336,12.516205778842151,11.153880344439818,9.9008817671803442,8.7572100470637242,7.7228651840899625,6.7978471782590564,5.9821560295710121,5.2757917380258235,4.6787543036234931,4.1910437263640183,3.8126600062473961,3.5436031432736357,3.3838731374427313,3.3334699887546848,3.3923936972094939,3.5606442628071631,3.8382216855476874,4.2251259654310678,4.7213571024573042,5.3269150966263981,6.0417999479383573,6.866011656393165,7.799550221990831,8.8424156447313518,9.9946079246147317,11.25612706164098,12.626973055810074,14.107145907122025,15.696645615576827,17.395472181174512,19.203625603915029],[58.340063234902118,54.927823141607654,51.624909905456057,48.431323526447308,45.347064004581419,42.372131339858392,39.506525532278211,36.750246581840898,34.103294488546432,31.565669252394834,29.137370873386089,26.818399351520199,24.608754686797166,22.50843687921699,20.517445928779676,18.635781835485215,16.863444599333612,15.200434220324864,13.646750698458973,12.202394033735942,10.86736422615577,9.6416612757184517,8.525285182423989,7.5182359462723864,6.6205135672636368,5.8321180453977508,5.1530493806747186,4.5833075730945456,4.1228926226572282,3.7718045293627633,3.5300432932111612,3.3976089142024151,3.3745013923365255,3.4607207276134924,3.6562669200333193,3.9611399695960006,4.3753398763015392,4.898866640149933,5.5317202611411851,6.2739007392753008,7.1254080745522659,8.086242266972091,9.1564033165347691,10.335891223240305,11.624705987088713,13.022847608079964,14.530316086214071,16.147111421491033,17.873233613910873,19.708682663473549],[57.516630831736776,54.131686365264471,50.856068755935027,47.689778003748437,44.632814108704707,41.685177070803832,38.846866890045817,36.117883566430656,33.498227099958349,30.987897490628903,28.586894738442318,26.295218843398587,24.112869805497709,22.039847624739689,20.076152301124534,18.221783834652232,16.476742225322784,14.841027473136196,13.314639578092461,11.897578540191589,10.589844359433572,9.3914370358184112,8.3023565693461059,7.3226029600166607,6.4521762078300711,5.6910763127863397,5.0393032748854649,4.4968570941274484,4.0637377705122892,3.7399453040399822,3.5254796947105378,3.4203409425239468,3.424529047480215,3.5380440095793388,3.7608858288213232,4.0930545052061635,4.5345500387338582,5.0853724294044094,5.745521677217817,6.514997782174091,7.3938007442732134,8.3819305635151977,9.4793872399000314,10.686170773427724,12.002281164098292,13.427718411911696,14.962482516867961,16.606573478967086,18.359991298209078,20.222735974593913],[56.702194680133275,53.344545840483129,50.096223857975843,46.957228732611405,43.927560464389835,41.007219053311118,38.196204499375256,35.494516802582254,32.902155962932113,30.419121980424823,28.045414855060393,25.781034586838814,23.625981175760099,21.580254621824238,19.643854925031238,17.816782085381092,16.099036102873804,14.490616977509372,12.991524709287795,11.601759298209082,10.321320744273221,9.1502090474802191,8.0884242078300712,7.1359662253227816,6.2928350999583484,5.5590308317367763,4.9345534206580606,4.4194028667222014,4.0135791699291987,3.7170823302790494,3.5299123477717615,3.4520692224073288,3.4835529541857548,3.6243635431070356,3.8745009891711777,4.2339652923781745,4.7027564527280274,5.280874470220736,5.968319344856301,6.7650910766347341,7.671189665556013,8.6866151116201511,9.8113674148271439,11.045446575176996,12.388852592669718,13.841585467305284,15.403645199083705,17.075031788004981,18.85574523406914,20.745785537276127],[55.896754780091619,52.566401567263632,49.345375211578506,46.233675713036227,43.231303071636816,40.338257287380259,37.554538360266548,34.880146290295706,32.315081077467717,29.859342721782586,27.512931223240315,25.275846581840899,23.148088797584336,21.129657870470634,19.220553800499793,17.420776587671806,15.730326231986673,14.149202733444396,12.677406092044981,11.31493630778842,10.06179338067472,8.917977310703872,7.8834880978758841,6.9583257421907536,6.1424902436484761,5.4359816022490621,4.8387998179925029,4.3509448908788011,3.9724168209079562,3.7032156080799647,3.5433412523948347,3.4927937538525606,3.5515731124531436,3.7196793281965821,3.9971124010828825,4.3838723311120358,4.879959118284046,5.4853727625989128,6.2001132640566361,7.0241806226572256,7.9575748384006628,9.0002959112869583,10.15234384131611,11.413718628488118,12.784420272802999,14.264448774260721,15.853804132861299,17.552486348604738,19.360495421491049,21.277831351520199],[55.100311131611818,51.79725354560599,48.603522816743016,45.519118945022896,42.544041930445644,39.678291773011239,36.921868472719694,34.274772029571011,31.737002443565174,29.308559714702202,26.989443842982087,24.77965482840483,22.679192670970426,20.68805737067888,18.806248927530195,17.033767341524364,15.37061261266139,13.816784740941271,12.372283726364014,11.037109568929614,9.8112622686380693,8.6947418254893787,7.6875482394835464,6.7896815106205741,6.0011416389004548,5.3219286243231974,4.7520424668887955,4.291483166597251,3.940250723448564,3.6983451374427303,3.5657664085797576,3.5425145368596413,3.6285895222823812,3.823991364847978,4.1287200645564361,4.5427756214077464,5.066158035401914,5.698867306538939,6.4409034348188188,7.2922664202415675,8.252956262807162,9.3229729625156157,10.502316519366925,11.79098693336109,13.188984204498128,14.696308332778008,16.312959318200743,18.038937160766338,19.874241860474807,21.818873417326113],[54.312863734693877,51.037101775510202,47.870666673469387,44.813558428571426,41.865777040816326,39.02732251020408,36.298194836734687,33.678394020408163,31.167920061224489,28.766772959183672,26.474952714285713,24.292459326530611,22.219292795918367,20.255453122448976,18.40094030612245,16.655754346938778,15.019895244897961,13.493363,12.076157612244897,10.768279081632654,9.5697274081632671,8.4805025918367374,7.5006046326530615,6.6300335306122449,5.8687892857142838,5.2168718979591837,4.6742813673469401,4.241017693877553,3.917080877551022,3.7024709183673461,3.5971878163265298,3.6012315714285696,3.7146021836734677,3.9372996530612205,4.2693239795918361,4.7106751632653046,5.2613532040816295,5.9213581020408101,6.6906898571428473,7.5693484693877524,8.5573339387755052,9.6546462653061145,10.861285448979581,12.177251489795903,13.602544387755099,15.137164142857138,16.781110755102031,18.534384224489781,20.39698455102041,22.368911734693871],[53.534412589337769,50.285946256976253,47.146806781757597,44.116994163681795,41.196508402748854,38.385349498958767,35.683517452311534,33.091012262807162,30.607833930445643,28.233982455226986,25.969457837151186,23.81426007621824,21.768389172428151,19.831845125780923,18.004627936276552,16.286737603915036,14.678174128696376,13.178937510620573,11.789027749687628,10.508444845897541,9.3371887992503133,8.2752596097459392,7.3226572773844225,6.4793818021657641,5.7454331840899595,5.1208114231570176,4.6055165193669296,4.1995484727197008,3.902907283215328,3.715592950853809,3.6376054756351515,3.6689448575593491,3.8096110966264041,4.0596041928363151,4.418924146189088,4.887570956684713,5.4655446243231962,6.1528451491045342,6.9494725310287304,7.855426770095792,8.8707078663057022,9.9953158196584706,11.229250630154093,12.572512297792573,14.025100822573929,15.587016204498122,17.258258443565175,19.038827539775077,20.928723493127865,22.927946303623486],[52.764957695543515,49.543786990004158,46.431943141607654,43.429426150354011,40.53623601624323,37.752372739275295,35.077836319450228,32.512626756768015,30.056744051228652,27.71018820283215,25.472959211578509,23.345057077467722,21.326481800499788,19.417233380674716,17.617311817992501,15.926717112453145,14.345449264056642,12.873508272802995,11.51089413869221,10.257606861724282,9.1136464418992098,8.0790128792169931,7.1537061736776328,6.3377263252811318,5.6310733340274854,5.0337471999167001,4.5457479229487703,4.1670755031236988,3.8977299404414829,3.7377112349021222,3.687019386505622,3.7456543952519779,3.9136162611411898,4.1909049841732582,4.5775205643481893,5.0734630016659725,5.6787322961266122,6.3933284477301084,7.2172514564764612,8.1505013223656828,9.1930780453977494,10.344981625572675,11.606212062890457,12.976769357351092,14.456653508954604,16.045864517700956,17.744402383590163,19.552267106622232,21.469458686797175,23.495977124114951],[52.004499053311115,48.810623974593916,45.726075753019572,42.750854388588088,39.884959881299459,37.128392231153683,34.481151438150768,31.94323750229071,29.51465042357351,27.195390201999164,24.985456837567678,22.88485033027905,20.89357068013328,19.01161788713036,17.238991951270307,15.575692872553104,14.021720650978761,12.577075286547274,11.24175677925864,10.015765129112872,8.8991003361099548,7.8917624002498981,6.9937513215326952,6.2050670999583506,5.5257097355268616,4.9556792282382336,4.4949755780924621,4.143598785089547,3.9015488492294885,3.7688257705122861,3.7454295489379419,3.8313601845064538,4.026617677217823,4.3312020270720488,4.7451132340691364,5.268351298209077,5.9009162194918749,6.6428079979175267,7.4940266334860377,8.4545721261974158,9.5244444760516398,10.703643683048721,11.992169747188658,13.390022668471454,14.897202446897122,16.513709082465635,18.239542575176998,20.074702925031218,22.019190132028324,24.073004196168256],[51.253036662640561,48.086457210745515,45.029204615993329,42.081278878384005,39.242679997917534,36.513407974593918,33.893462808413162,31.38284449937526,28.981553047480212,26.689588452728028,24.506950715118702,22.433639834652226,20.469655811328611,18.614998645147853,16.869668336109953,15.233664884214912,13.706988289462725,12.289638551853393,10.981615671386921,9.7829196480633058,8.69355048188255,7.713508172844648,6.8427927209496033,6.0814041261974179,5.4293423885880854,4.8866075081216156,4.4531994847980005,4.1291183186172438,3.9143640095793422,3.8089365576842966,3.8128359629321107,3.9260622253227808,4.1486153448563083,4.4804953215326906,4.9217021553519373,5.4722358463140344,6.1320963944189888,6.9012837996667997,7.7797980620574672,8.7676391815910026,9.8648071582673857,11.071301992086624,12.387123683048719,13.812272231153672,15.346747636401497,16.990549898792167,18.74367901832569,20.606134995002069,22.577917828821327,24.659027519783422],[50.510570523531854,47.371286698458974,44.34132973052894,41.420699619741768,38.609396366097457,35.907419969595992,33.314770430237395,30.831447748021656,28.457451922948767,26.192782955018739,24.037440844231568,21.991425590587252,20.054737194085796,18.227375654727194,16.509340972511453,14.900633147438567,13.401252179508537,12.011198068721363,10.73047081507705,9.5590704185755939,8.4969968792169936,7.5442501970012499,6.7008303719283617,5.9667374039983327,5.3419712932111594,4.8265320395668461,4.4204196430653884,4.123634103706789,3.9361754214910452,3.8580435964181574,3.8892386284881293,4.0297605177009572,4.2796092640566412,4.6387848675551817,5.1072873281965867,5.6851166459808411,6.3722728209079529,7.1687558529779221,8.074565742190746,9.0897024885464397,10.21416609204498,11.447956552686378,12.79107387047063,14.243518045397739,15.805289077467725,17.476386966680547,19.256811713036228,21.146563316534767,23.145641777176184,25.254047094960434],[49.777100635985001,46.665112437734273,43.662451096626405,40.769116612661392,37.985108985839233,35.310428216159934,32.745074303623483,30.289047248229902,27.942347049979176,25.704973708871304,23.576927224906289,21.558207598084131,19.648814828404831,17.848748915868384,16.158009860474806,14.576597662224074,13.104512321116204,11.741753837151188,10.488322210329027,9.3442174406497305,8.3094395281132876,7.383988472719702,6.5678642744689721,5.8610669333610987,5.2635964493960827,4.7754528225739268,4.3966360528946273,4.1271461403581844,3.9669830849645984,3.9161468867138685,3.9746375456059964,4.1424550616409803,4.4195994348188226,4.8060706651395195,5.301868752603081,5.9069936972094936,6.6214454989587637,7.4452241578508875,8.3783296738858688,9.4207620470637217,10.572521277384416,11.833607364847971,13.20402030945438,14.683760111203648,16.27282677009579,17.971220286130773,19.77894065930861,21.695987889629304,23.722361977092881,25.858062921699286],[49.052626999999994,45.967934428571425,42.99256871428571,40.126529857142849,37.369817857142856,34.722432714285709,32.184374428571424,29.755642999999999,27.436238428571425,25.226160714285712,23.125409857142856,21.133985857142857,19.251888714285712,17.479118428571425,15.815675000000001,14.26155842857143,12.816768714285715,11.481305857142855,10.255169857142857,9.1383607142857137,8.13087842857143,7.232723,6.4438944285714284,5.7643927142857141,5.1942178571428546,4.7333698571428569,4.381848714285713,4.1396544285714292,4.0067869999999992,3.9832464285714271,4.0690327142857132,4.2641458571428554,4.568585857142855,4.9823527142857094,5.5054464285714291,6.1378669999999982,6.8796144285714256,7.7306887142857077,8.6910898571428472,9.7608178571428557,10.939872714285709,12.228254428571422,13.62596299999999,15.132998428571414,16.749360714285714,18.475049857142853,20.310065857142849,22.254408714285699,24.308078428571431,26.471074999999995]],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"beta1_hat"},"yaxis":{"title":"beta0_hat"},"zaxis":{"title":"RSS"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[0.40000000000000002,0.41224489795918368,0.42448979591836739,0.43673469387755104,0.44897959183673469,0.4612244897959184,0.47346938775510206,0.48571428571428577,0.49795918367346942,0.51020408163265307,0.52244897959183678,0.53469387755102038,0.54693877551020409,0.5591836734693878,0.5714285714285714,0.58367346938775511,0.59591836734693882,0.60816326530612241,0.62040816326530612,0.63265306122448983,0.64489795918367343,0.65714285714285714,0.66938775510204085,0.68163265306122445,0.69387755102040816,0.70612244897959187,0.71836734693877546,0.73061224489795917,0.74285714285714288,0.75510204081632648,0.76734693877551019,0.7795918367346939,0.7918367346938775,0.80408163265306121,0.81632653061224492,0.82857142857142851,0.84081632653061222,0.85306122448979593,0.86530612244897953,0.87755102040816324,0.88979591836734695,0.90204081632653066,0.91428571428571426,0.92653061224489797,0.93877551020408168,0.95102040816326527,0.96326530612244898,0.97551020408163269,0.98775510204081629,1],"y":[0.001,0.0012857142857142856,0.0015714285714285713,0.0018571428571428571,0.0021428571428571425,0.0024285714285714284,0.0027142857142857142,0.0029999999999999996,0.0032857142857142855,0.0035714285714285713,0.0038571428571428567,0.0041428571428571426,0.0044285714285714284,0.0047142857142857143,0.0049999999999999992,0.0052857142857142851,0.0055714285714285709,0.0058571428571428568,0.0061428571428571426,0.0064285714285714276,0.0067142857142857134,0.0069999999999999993,0.0072857142857142851,0.007571428571428571,0.0078571428571428577,0.0081428571428571427,0.0084285714285714276,0.0087142857142857126,0.0089999999999999976,0.009285714285714286,0.009571428571428571,0.009857142857142856,0.010142857142857141,0.010428571428571426,0.010714285714285714,0.010999999999999999,0.011285714285714284,0.011571428571428569,0.011857142857142854,0.012142857142857143,0.012428571428571428,0.012714285714285713,0.012999999999999998,0.013285714285714283,0.013571428571428571,0.013857142857142856,0.014142857142857141,0.014428571428571426,0.014714285714285714,0.014999999999999999],"z":[[95.131426999999988,90.709248714285707,86.396397285714272,82.192872714285713,78.098675,74.113804142857134,70.238260142857129,66.472042999999999,62.815152714285709,59.26758928571428,55.829352714285712,52.500442999999997,49.280860142857144,46.170604142857137,43.169675000000005,40.278072714285713,37.495797285714289,34.822848714285712,32.259226999999996,29.804932142857144,27.459964142857142,25.224323000000005,23.098008714285715,21.081021285714286,19.17336071428571,17.375026999999999,15.686020142857146,14.10634014285715,12.635987000000009,11.274960714285712,10.023261285714286,8.8808887142857156,7.8478430000000055,6.9241241428571501,6.1097321428571414,5.4046670000000008,4.8089287142857167,4.3225172857142873,3.9454327142857171,3.6776749999999989,3.5192441428571422,3.4701401428571423,3.5303629999999986,3.6999127142857122,3.978789285714285,4.366992714285713,4.8645229999999966,5.4713801428571376,6.187564142857144,7.0130749999999971],[93.975133289046227,89.580250630154097,85.294694828404829,81.118465883798407,77.051563796334861,73.093988566014161,69.245740192836308,65.506818676801331,61.877224017909199,58.356956216159929,54.94601527155352,51.644401184089965,48.452113953769256,45.369153580591416,42.395520064556436,39.53121340566431,36.776233603915038,34.13058065930862,31.594254571845063,29.167255341524367,26.849582968346525,24.64123745231154,22.542218793419408,20.552526991670138,18.672162047063718,16.901123959600167,15.239412729279469,13.68702835610163,12.243970840066648,10.910240181174506,9.6858363794252398,8.570759434818827,7.5650093473552733,6.6685861170345753,5.881489743856724,5.2037202278217416,4.635277568929614,4.1761617671803437,3.82637282257393,3.5859107351103701,3.4547755047896707,3.4329671316118282,3.5204856155768414,3.7173309566847128,4.0235031549354439,4.4390022103290292,4.9638281228654701,5.5979808925447685,6.3414605193669322,7.1942670033319445],[92.827835829654305,88.460248797584327,84.201988622657211,80.053055304872956,76.013448844231561,72.083169240733014,68.262216494377341,64.550590605164516,60.948291573094536,57.455319398167426,54.071674080383175,50.797355619741772,47.63236401624323,44.576699269887541,41.630361380674721,38.793350348604747,36.065666173677634,33.447308855893375,30.938278395251977,28.53857479175344,26.248198045397753,24.067148156184924,21.995425124114952,20.033028949187837,18.179959631403573,16.43621717076218,14.80180156726364,13.276712820907958,11.860950931695134,10.55451589962515,9.3574077246980405,8.2696264069137868,7.2911719462723887,6.4220443427738489,5.6622435964181559,5.01176970720533,4.4706226751353597,4.0388025002082477,3.7163091824239918,3.5031427217825892,3.3993031182840476,3.404790371928363,3.5196044827155339,3.7437454506455627,4.0772132757184512,4.5200079579341939,5.0721294972927931,5.7335778937942488,6.5043531474385707,7.3844552582257403],[91.689534621824237,87.349243216576411,83.118278668471461,78.996640977509358,74.984330143690116,71.081346167013734,67.2876890474802,63.60335878508954,60.028355379841727,56.562678831736768,53.206329140774677,49.959306306955433,46.82161033027905,43.793241210745514,40.874198948354852,38.064483543107038,35.364094995002084,32.773033304039984,30.291298470220738,27.918890493544357,25.655809374010829,23.502055111620162,21.457627706372346,19.522527158267387,17.696753467305285,15.980306633486046,14.373186656809665,12.875393537276141,11.486927274885474,10.207787869637649,9.037975321532695,7.9774896305705969,7.0263307967513589,6.1844988200749755,5.4519937005414398,4.8288154381507713,4.3149640329029593,3.910439484798002,3.6152417938359038,3.4293709600166586,3.352826983340274,3.3856098638067462,3.5277196014160745,3.7791561961682603,4.139919648063306,4.6100099571012061,5.1894271232819618,5.8781711466055748,6.6762420270720542,7.5836397646813793],[90.560229665556008,86.247233887130363,82.043564965847565,77.949222901707614,73.964207694710538,70.088519344856309,66.322157852144926,62.665123216576426,59.117415438150765,55.679034516867972,52.349980452728033,49.130253245730948,46.019852895876717,43.01877940316534,40.127032767596837,37.344612989171182,34.67152006788838,32.107754003748433,29.653314796751353,27.308202446897127,25.072416954185758,22.945958318617244,20.928826540191587,19.021021618908787,17.222543554768841,15.533392347771761,13.953567997917537,12.483070505206168,11.121899869637661,9.8700560912119908,8.7275391699291962,7.6943491057892563,6.7704858987921748,5.9559495489379479,5.2507400562265705,4.6548574206580593,4.1683016422324037,3.7910727209496056,3.5231706568096643,3.3645954498125774,3.3153470999583501,3.3754256072469802,3.5448309716784654,3.8235631932528089,4.2116222719700129,4.7090082078300703,5.3157210008329834,6.0317606509787538,6.8571271582673905,7.7918205226988748],[89.439920960849634,85.154220809246141,80.977847514785495,76.91080107746771,72.953081497292786,69.104688774260723,65.365622908371506,61.735883899625158,58.215471748021649,54.804386453561008,51.502628016243229,48.310196436068303,45.227091713036238,42.253313847147012,39.388862838400669,36.633738686797173,33.987941392336531,31.451470955018742,29.024327374843814,26.706510651811747,24.498020785922535,22.398857777176179,20.409021625572677,18.528512331112037,16.757329893794246,15.095474313619322,13.542945590587255,12.099743724698046,10.765868715951694,9.5413205643481831,8.4260992698875459,7.4202048325697634,6.5236372523948383,5.7363965293627697,5.0584826634735496,4.4898956547271958,4.0306355031236984,3.6807022086630576,3.4400957713452738,3.3088161911703446,3.2868634681382751,3.3742376022490626,3.5709385935027056,3.8769664418992065,4.2923211474385683,4.8170027101207831,5.4510111299458543,6.1943464069137821,7.0470085410245771,8.0089975322782188],[88.328608507705113,84.070203982923772,79.921126315285292,75.881375504789659,71.950951551436901,68.129854455226976,64.418084216159926,60.81564083423573,57.322524309454387,53.938734641815905,50.664271831320285,47.499135877967511,44.443326781757598,41.496844542690539,38.659689160766348,35.931860635985004,33.31335896834652,30.804184157850894,28.404336204498122,26.113815108288215,23.932620869221157,21.860753487296964,19.898212962515618,18.044999294877133,16.301112484381502,14.666552531028737,13.141319434818827,11.725413195751777,10.418833813827581,9.2215812890462274,8.1336556214077476,7.1550568109121215,6.2857848575593547,5.5258397613494434,4.8752215222823816,4.3339301403581851,3.9019656155768447,3.5793279479383595,3.3660171374427335,3.2620331840899612,3.2673760878800486,3.3820458488129934,3.6060424668887938,3.9393659421074516,4.3820162744689704,4.9339934639733425,5.5952975106205702,6.3659284144106554,7.2458861753436077,8.2351707934194049],[87.226292306122446,82.995183408163257,78.873401367346929,74.860946183673462,70.957817857142857,67.164016387755098,63.479541775510192,59.904394020408162,56.438573122448972,53.082079081632649,49.834911897959181,46.697071571428566,43.668558102040812,40.749371489795912,37.93951173469388,35.238978836734695,32.647772795918364,30.165893612244897,27.793341285714281,25.530115816326532,23.376217204081634,21.331645448979593,19.396400551020406,17.570482510204084,15.853891326530604,14.246626999999998,12.748689530612245,11.36007891836735,10.080795163265314,8.9108382653061167,7.8502082244897942,6.8989050408163273,6.0569287142857169,5.3242792448979639,4.7009566326530594,4.1869608775510194,3.7822919795918373,3.4869499387755112,3.3009347551020416,3.2242464285714276,3.2568849591836728,3.3988503469387745,3.6501425918367323,4.0107616938775479,4.4807076530612244,5.0599804693877539,5.7485801428571399,6.5465066734693824,7.4537600612244921,8.4703403061224485],[86.132972356101618,81.929159084964596,77.83467267097042,73.849513114119105,69.973680414410651,66.207174571845059,62.54999558642232,59.002143458142442,55.56361818700541,52.23441977301124,49.01454821615993,45.904003516451475,42.90278567388588,40.010894688463132,37.228330560183259,34.555093289046233,31.991182875052065,29.53659931820075,27.191342618492293,24.9554127759267,22.828809790503961,20.811533662224075,18.903584391087044,17.104961977092877,15.415666420241561,13.835697720533108,12.365055877967514,11.003740892544776,9.7517527642648965,8.6090914931278579,7.5757570791336928,6.6517495222823833,5.8370688225739293,5.1317149800083337,4.5356879945855866,4.0489878663057057,3.6716145951686796,3.4035681811745109,3.2448486243231991,3.1954559246147434,3.2553900820491455,3.4246510966264054,3.7032389683465201,4.0911536972094931,4.5883952832153279,5.1949637263640147,5.910859026655559,6.7360811840899579,7.6706301986672258,8.7145060703873405],[85.048648657642644,80.872131013327774,76.804940226155765,72.847076296126602,68.998539223240314,65.259329007496873,61.629445648896287,58.108889147438568,54.697659503123695,51.395756715951684,48.203180785922534,45.11993171303623,42.146009497292795,39.281414138692206,36.526145637234485,33.880203992919618,31.343589205747605,28.91630127571845,26.598340202832151,24.389705987088714,22.290398628488131,20.300418127030408,18.419764482715536,16.648437695543521,14.986437765514365,13.43376469262807,11.990418476884633,10.656399118284055,9.4317066168263306,8.3163409725114512,7.3103021853394434,6.4135902553102886,5.6262051824239938,4.9481469666805555,4.3794156080799658,3.9200111066222414,3.5699334623073731,3.3291826751353604,3.1977587451062064,3.1756616722199071,3.2628914564764666,3.4594480978758835,3.765331596418156,4.1805419521032858,4.705079164931278,5.3389432349021222,6.082134162015822,6.9346519462723792,7.8964965876718045,8.9676680862140739],[83.97332121074551,79.824099193252806,75.784204032902949,71.853635729695952,68.032394283631817,64.320479694710528,60.7178919629321,57.22463108829654,53.84069707080382,50.566089910453975,47.400809607246977,44.34485616118284,41.398229572261549,38.560929840483126,35.832956965847565,33.21431094835485,30.704991788005,28.304999484798,26.014334038733857,23.832995449812579,21.760983718034154,19.798298843398584,17.944940825905871,16.200909665556019,14.566205362349013,13.040827916284879,11.624777327363597,10.318053595585177,9.1206567209496114,8.0325867034568876,7.0538435431070372,6.1844272399000424,5.4243377938359041,4.7735752049146223,4.2321394731361917,3.8000305985006242,3.4772485810079137,3.2637934206580592,3.1596651174510622,3.1648636713869212,3.2793890824656384,3.5032413506872122,3.836420476051642,4.2789264585589297,4.8307592982090801,5.4919189950020808,6.2624055489379389,7.1422189600166535,8.131359228238237,9.2298263536026646],[82.906990015410244,78.785063624739692,74.772464091211987,70.869191414827156,67.075245595585173,63.39062663348605,59.815334528529775,56.349369280716374,52.992730890045813,49.745419356518113,46.607434680133281,43.578776860891296,40.659445898792171,37.849441793835901,35.148764546022491,32.557414155351942,30.075390621824244,27.702693945439403,25.439324126197416,23.285281164098297,21.240565059142028,19.305175811328617,17.479113420658059,15.762377887130365,14.15496921074552,12.656887391503542,11.268132429404417,9.9887043244481521,8.8186030766347461,7.7578286859641796,6.8063811524364866,5.9642604760516464,5.2314666568096655,4.6079996947105419,4.0938595897542687,3.689046341940859,3.3935599512703063,3.207400417742607,3.1305677413577673,3.1630619221157845,3.3048829600166578,3.5560308550603907,3.9165056072469766,4.3863072165764212,4.9654356830487307,5.653891006663887,6.4516731874219024,7.3587822253227753,8.3752181203665153,9.5009808725531002],[81.849655071636803,77.755024307788418,73.769720401082878,69.893743351520186,66.127093159100369,62.469769823823405,58.921773345689289,55.48310372469804,52.153760960849645,48.933745054144104,45.823056004581424,42.821693812161598,39.929658476884633,37.146949998750515,34.473568377759271,31.909513613910871,29.454785707205332,27.10938465764265,24.873310465222822,22.746563129945859,20.729142651811745,18.821049030820493,17.022282266972095,15.332842360266556,13.752729310703868,12.281943118284048,10.920483783007082,9.6683513048729761,8.5255456838817238,7.4920669200333174,6.5679150133277808,5.753089963765099,5.0475917713452763,4.4514204360683092,3.9645759579341933,3.587058336942941,3.3188675730945452,3.1600036663890041,3.1104666168263222,3.1702564244064959,3.3393730891295275,3.6178166109954164,4.0055869900041614,4.5026842261557629,5.109108319450228,5.8248592698875443,6.6499370774677171,7.5843417421907455,8.6280732640566438,9.7811316430653861],[80.801316379425231,76.733981242398997,72.77597296251561,68.927291539775084,65.187936974177418,61.557909265722614,58.037208414410657,54.62583442024156,51.323787283215317,48.131067003331943,45.047673580591422,42.073607014993748,39.208867306538934,36.453454455226982,33.807368461057891,31.270609324031653,28.843177044148273,26.525071621407744,24.316293055810075,22.21684134735527,20.226716496043316,18.34591850187422,16.574447364847977,14.912303084964599,13.359485662224067,11.915995096626405,10.581831388171596,9.356994536859645,8.2414845426905519,7.2353014056643019,6.3384451257809236,5.5509157030404008,4.8727131374427346,4.3038374289879249,3.8442885776759668,3.4940665835068714,3.2531714464806334,3.121603166597251,3.099361743856726,3.1864471782590575,3.3828594698042473,3.6885986184922932,4.1036646243231951,4.6280574872969549,5.2617772074135782,6.004823784673051,6.8571972190753812,7.8188975106205678,8.8899246593086243,10.070278665139524],[79.761973938775512,75.72193442857143,71.791221775510209,67.969835979591835,64.257777040816322,60.65504495918367,57.161639734693878,53.777561367346941,50.502809857142857,47.337385204081635,44.281287408163266,41.334516469387758,38.497072387755104,35.768955163265304,33.150164795918371,30.64070128571429,28.240564632653065,25.949754836734694,23.768271897959181,21.696115816326532,19.733286591836741,17.8797842244898,16.135608714285716,14.500760061224492,12.975238265306121,11.559043326530613,10.252175244897963,9.0546340204081677,7.9664196530612337,6.9875321428571402,6.1179714897959201,5.3577376938775521,4.7068307551020432,4.1652506734693917,3.732997448979591,3.4100710816326538,3.1964715714285732,3.092198918367346,3.0972531224489783,3.211634183673469,3.4353421020408139,3.7683768775510194,4.2107385102040773,4.7624269999999935,5.423442346938776,6.1937845510204053,7.0734536122448928,8.0624495306122377,9.1607723061224497,10.368421938775509],[78.731627749687618,74.718883866305703,70.815466840066634,67.021376670970426,63.336613359017072,59.761176904206579,56.295067306538932,52.938284566014161,49.69082868263223,46.552699656393166,43.523897487296956,40.604422175343601,37.794273720533113,35.093452122865465,32.501957382340692,30.019789498958769,27.646948472719703,25.383434303623492,23.229246991670134,21.184386536859645,19.248852939192005,17.422646198667227,15.705766315285299,14.09821328904623,12.599987119950017,11.211087807996668,9.9315153531861746,8.7612697555185388,7.7003510149937595,6.7487591316118261,5.9064941053727624,5.1735559362765526,4.549944624323202,4.035660169512707,3.6307025718450636,3.3350718313202834,3.1487679479383597,3.0717909216992911,3.1041407526030809,3.245817440649728,3.4968209858392316,3.8571513881715926,4.3268086476468088,4.9057927642648833,5.5941037380258214,6.3917415689296098,7.2987062569762546,8.3149978021657542,9.4406162044981272,10.67556146397334],[77.710277812161593,73.724829555601829,69.848708156184912,66.081913613910856,62.424445928779676,58.876305100791335,55.437491129945847,52.108004016243228,48.887843759683456,45.777010360266551,42.775503817992501,39.883324132861304,37.100471304872961,34.426945334027486,31.862746220324865,29.407873963765098,27.062328564348189,24.826110022074133,22.699218336942938,20.6816535089546,18.773415538109123,16.974504424406497,15.28492016784673,13.70466276842982,12.233732226155762,10.872128541024571,9.6198517130362351,8.4769017421907567,7.4432786284881365,6.5189823719283586,5.7040129725114523,4.9983704302374017,4.4020547451062075,3.9150659171178703,3.5374039462723852,3.2690688325697619,3.110060576009996,3.0603791765930857,3.1200246343190328,3.2889969491878372,3.5672961211994991,3.9549221503540171,4.4518750366513915,5.0581547800916224,5.7737613806747188,6.5986948384006645,7.5329551532694667,8.5765423252811264,9.7294563544356532,10.991697240733027],[76.697924126197421,72.739771496459809,68.890945723865059,65.151446808413155,61.521274750104119,58.000429548937944,54.588911204914616,51.286719718034156,48.093855088296543,45.010317315701791,42.036106400249899,39.171222341940862,36.415665140774678,33.769434796751348,31.23253130987089,28.804954680133282,26.486704907538527,24.277781992086634,22.178185933777591,20.187916732611416,18.306974388588092,16.535358901707625,14.873070271970013,13.320108499375262,11.876473583923364,10.54216552561433,9.3171843244481494,8.2015299804248265,7.1952024935443646,6.298201863806745,5.510528091211996,4.832181175760101,4.2631611174510642,3.8034679162848843,3.453101572261557,3.2120620853810919,3.0803494556434829,3.0579636830487282,3.1449047675968327,3.3411727092877959,3.6467675081216133,4.0616891640982908,4.5859376772178209,5.2195130474802092,5.9624152748854655,6.8146443594335651,7.7762003011245255,8.8470830999583434,10.027292755935028,11.316829269054558],[75.694566691795075,71.763709688879629,67.942179543107031,64.229976254477293,60.627099822990417,57.133550248646394,53.749327531445225,50.474431671386924,47.30886266847147,44.252620522698869,41.305705234069137,38.468116802582252,35.739855228238234,33.120920511037063,30.611312650978761,28.211031648063308,25.920077502290713,23.738450213660975,21.666149782174092,19.703176207830072,17.849529490628907,16.105209630570599,14.470216627655144,12.944550481882548,11.528211193252808,10.22119876176593,9.0235131874219103,7.9351544702207457,6.9561226101624385,6.0864176072469789,5.3260394614743864,4.6749881728446487,4.1332637413577702,3.7008661670137473,3.3777954498125773,3.1640515897542691,3.0596345868388175,3.064544441066221,3.1787811524364824,3.4023447209496029,3.7352351466055786,4.1774524294044113,4.7289965693461005,5.389867566430647,6.1600654206580581,7.0395901320283185,8.0284417005414355,9.1266201261974071,10.334125408996254,11.650957548937939],[74.700205508954596,70.796644132861303,67.002409613910856,63.317501952103278,59.741921147438568,56.275667199916697,52.918740109537687,49.671139876301538,46.532866500208243,43.503919981257802,40.584300319450229,37.774007514785502,35.073041567263637,32.481402476884625,29.999090243648482,27.626104867555185,25.362446348604749,23.208114686797167,21.163109882132442,19.227431934610578,17.401080844231572,15.68405661099542,14.076359234902123,12.577988715951687,11.188945054144101,9.9092282494793817,8.738838301957518,7.6777752115785116,6.7260389783423626,5.8836296022490586,5.1505470832986244,4.5267914214910459,4.0123626168263238,3.6072606693044582,3.3114855789254465,3.1250373456892957,3.0479159695960014,3.0801214506455632,3.2216537888379824,3.4725129841732603,3.8326990366513938,4.3022119462723847,4.8810517130362303,5.5692183369429333,6.3667118179925035,7.2735321561849213,8.2896793515201956,9.4151534039983265,10.649954313619329,11.994082080383173],[73.714840577675972,69.83857482840483,66.07163593627655,62.414023901291131,58.865738723448558,55.426780402748854,52.097148939192003,48.876844332778013,45.76586658350687,42.764215691378588,39.871891656393174,37.088894478550607,34.415224157850901,31.850880694294041,29.395864087880053,27.050174338608915,24.813811446480635,22.686775411495212,20.669066233652643,18.760683912952938,16.961628449396091,15.271899842982092,13.691498093710955,12.220423201582676,10.85867516659725,9.6062539887546876,8.4631596680549794,7.4293922044981295,6.5049515980841397,5.689837848812993,4.9840509566847162,4.3875909216992923,3.9004577438567276,3.5226514231570203,3.2541719596001659,3.0950193531861729,3.045193603915036,3.1046947117867534,3.2735226768013299,3.5516774989587661,3.9391591782590556,4.4359677147022056,5.0421031082882068,5.7575653590170681,6.5823544668887974,7.5164704319033699,8.5599132540608025,9.7126829333610907,10.974779469804249,12.34620286339025],[72.738471897959187,68.889501775510197,65.149858510204083,61.519542102040809,57.99855255102041,54.58688985714285,51.284554020408159,48.091545040816328,45.007862918367344,42.033507653061221,39.168479244897959,36.412777693877551,33.766402999999997,31.2293551632653,28.801634183673471,26.483240061224489,24.274172795918368,22.174432387755104,20.18401883673469,18.302932142857145,16.53117230612245,14.868739326530616,13.315633204081633,11.87185393877551,10.537401530612241,9.3122759795918366,8.1964772857142876,7.1900054489795968,6.2928604693877608,5.5050423469387741,4.8265510816326538,4.2573866734693881,3.7975491224489817,3.4470384285714308,3.2058545918367338,3.0739976122448978,3.0514674897959182,3.1382642244897938,3.3343878163265277,3.6398382653061212,4.0546155714285685,4.5787197346938742,5.2121507551020345,5.9549086326530531,6.8069933673469372,7.7684049591836706,8.8391434081632596,10.019208714285703,11.308600877551022,12.707319897959179],[71.771099469804241,67.949424974177418,64.237077335693456,60.634056554352348,57.140362630154101,53.755995563098708,50.480955353186168,47.31524200041649,44.258855504789665,41.311795866305701,38.474063084964598,35.745657160766342,33.126578093710947,30.616825883798413,28.216400531028739,25.925302035401916,23.743530396917951,21.671085615576843,19.707967691378588,17.854176624323198,16.109712414410666,14.474575061640984,12.948764566014159,11.532280927530197,10.225124146189081,9.0272942219908359,7.9387911549354433,6.9596149450229099,6.089765592253233,5.3292430966264019,4.6780474581424398,4.1361786768013333,3.7036367526030833,3.3804216855476898,3.1665334756351511,3.0619721228654719,3.0667376272386502,3.180829988754684,3.4042492074135748,3.7369952832153261,4.1790682161599317,4.7304680062473947,5.3911946534777124,6.1612481578508875,7.0406285193669307,8.0293357380258215,9.127369813827567,10.334730746772172,11.651418536859644,13.07743318408996],[70.812723293211164,67.018344424406493,63.33329241274469,59.757567258225741,56.291168960849646,52.934097520616412,49.686352937526031,46.547935211578512,43.518844342773846,40.599080331112035,37.788643176593091,35.087532879216994,32.495749438983758,30.013292855893376,27.640163129945858,25.376360261141194,23.221884249479384,21.176735094960435,19.24091279758434,17.414417357351105,15.697248774260729,14.089407048313205,12.590892179508538,11.201704167846733,9.9218430133277788,8.7513087159516889,7.6901012757184519,6.738220692628075,5.8956669666805563,5.1624400978758835,4.5385400862140788,4.023966931695127,3.6187206343190348,3.3228011940857991,3.1362086109954177,3.0589428850478972,3.0910040162432324,3.2323920045814214,3.48310685006247,3.8431485526863791,4.3125171124531407,4.8912125293627629,5.579234803415237,6.3765839346105695,7.2832599229487718,8.2992627684298164,9.424592471053721,10.659249030820483,12.003232447730113,13.456542721782586],[69.863343368179926,66.096260126197407,62.438503741357771,58.890074213660967,55.450971543107038,52.121195729695955,48.900746773427734,45.789624674302374,42.787829432319867,39.895361047480215,37.112219519783423,34.438404849229485,31.873917035818408,29.418756079550185,27.072921980424827,24.836414738442315,22.709234353602668,20.691380825905874,18.782854155351934,16.983654341940859,15.293781385672638,13.713235286547276,12.242016044564766,10.880123659725115,9.6275581320283177,8.4843194614743851,7.450407648063309,6.5258226917950894,5.7105645926697264,5.0046333506872127,4.4080289658475635,3.9207514381507709,3.5428007675968365,3.2741769541857573,3.1148799979175337,3.0649098987921697,3.1242666568096622,3.2929502719700099,3.5709607442732154,3.9582980737192823,4.4549622603082017,5.0609533040399795,5.7762712049146119,6.6009159629321026,7.5348875780924596,8.5781860503956651,9.7308113798417253,10.992763566430643,12.364042610162434,13.844648511037065],[68.922959694710528,65.183172079550175,61.552711321532691,58.031577420658053,54.619770376926276,51.31729019033736,48.124136860891291,45.040310388588082,42.065810773427735,39.200638015410242,36.444792114535609,33.79827307080383,31.261080884214905,28.833215554768842,26.514677082465639,24.305465467305289,22.205580709287798,20.21502280841316,18.333791764681379,16.56188757809246,14.899310248646399,13.346059776343191,11.902136161182838,10.567539403165348,9.3422695022907067,8.2263264585589333,7.2197102719700128,6.3224209425239506,5.5344584702207458,4.8558228550603886,4.2865140970428977,3.8265321961682632,3.4758771524364858,3.2345489658475639,3.1025476364014986,3.0798731640982915,3.1665255489379418,3.3625047909204477,3.6678108900458111,4.0824438463140353,4.606403659725113,5.2396903302790472,5.9823038579758379,6.834244242815485,7.7955114847980012,8.866105583923364,10.046026540191582,11.335274353602657,12.733849024156605,14.241750551853393],[67.991572272802998,64.279080284464811,60.675915153269472,57.182076879216993,53.797565462307375,50.522380902540611,47.356523199916701,44.299992354435652,41.352788366097457,38.514911234902122,35.786360960849649,33.167137543940029,30.657240984173264,28.256671281549352,25.965428436068308,23.783512447730114,21.710923316534778,19.747661042482303,17.893725625572678,16.149117065805918,14.513835363182011,12.98788051770096,11.571252529362766,10.263951398167432,9.0659771241149514,7.9773297072053326,6.9980091474385686,6.1280154448146638,5.3673485993336172,4.7160086109954165,4.1739954798000847,3.7413092057476049,3.4179497888379848,3.2039172290712212,3.0992115264473128,3.1038326809662644,3.2177806926280716,3.4410555614327327,3.7736572873802534,4.2155858704706359,4.7668413107038692,5.4274236080799643,6.1973327625989096,7.0765687742607142,8.0651316430653903,9.1630213690129061,10.370237952103283,11.686781392336517,13.112651689712621,14.647848844231566],[67.069181102457307,63.383984740941273,59.808115236568092,56.341572589337773,52.984356799250314,49.736467866305702,46.597905790503951,43.568670571845061,40.648762210329025,37.83818070595585,35.136926058725528,32.544998268638068,30.062397335693461,27.689123259891709,25.425176041232824,23.270555679716786,21.225262175343609,19.289295528113286,17.46265573802582,15.745342805081219,14.137356729279468,12.638697510620577,11.249365149104541,9.9693596447313624,8.7986809975010392,7.7373292074135778,6.7853042744689729,5.9426061986672263,5.2092349800083344,4.5851906184922937,4.0704731141191175,3.6650824668887965,3.3690186768013342,3.182281743856727,3.1048716680549764,3.1367884493960845,3.2780320878800491,3.5286025835068688,3.8884999362765469,4.3577241461890859,4.9362752132444783,5.6241531374427272,6.4213579187838326,7.3278895572677953,8.3437480528946253,9.4689334056643037,10.703445615576836,12.047284682632224,13.500450606830489,15.062943388171592],[66.155786183673456,62.497885448979588,58.949311571428566,55.510064551020399,52.180144387755099,48.959551081632647,45.848284632653055,42.846345040816324,39.953732306122447,37.170446428571424,34.496487408163269,31.931855244897957,29.476549938775506,27.130571489795912,24.893919897959186,22.766595163265308,20.748597285714286,18.839926265306122,17.040582102040812,15.350564795918366,13.769874346938778,12.298510755102042,10.936474020408163,9.683764142857143,8.5403811224489754,7.5063249591836732,6.5815956530612238,5.7661932040816346,5.0601176122449019,4.4633688775510176,3.9759469999999992,3.5978519795918369,3.3290838163265311,3.1696425102040817,3.1195280612244893,3.1787404693877543,3.3472797346938767,3.6251458571428548,4.0123388367346902,4.508858673469387,5.1147053673469367,5.8298789183673438,6.6543793265306057,7.5882065918367259,8.6313607142857141,9.7838416938775499,11.04564953061224,12.416784224489788,13.897245775510207,15.487034183673467],[65.251387516451473,61.620782408579757,58.099504157850895,54.687552764264886,51.384928227821739,48.191630548521452,45.107659726364012,42.133015761349441,39.267698653477716,36.511708402748852,33.865045009162849,31.327708472719703,28.899698793419411,26.581015971261973,24.371660006247399,22.27163089837568,20.280928647646814,18.399553254060809,16.627504717617658,14.964783038317371,13.411388216159938,11.967320251145358,10.632579143273636,9.4071648925447757,8.2910774989587672,7.2843169625156197,6.3868832832153286,5.5987764610578958,4.9199964960433205,4.3505433881715936,3.890417137442733,3.5396177438567258,3.2981452074135778,3.1659995281132862,3.1431807059558508,3.2296887409412744,3.4255236330695538,3.7306853823406878,4.1451739887546797,4.6689894523115347,5.3021317730112409,6.0446009508538072,6.8963969858392247,7.8575198779675022,8.9279696272386513,10.107746233652639,11.396849697209488,12.795280017909194,14.30303719575177,15.920121230737189],[64.35598510079133,60.752675619741773,57.258692995835069,53.874037229071213,50.598708319450232,47.43270626697209,44.37603107163681,41.428682733444397,38.590661252394831,35.861966628488126,33.242598861724282,30.732557952103289,28.331843899625156,26.040456704289877,23.858396366097463,21.785662885047898,19.822256261141192,17.968176494377342,16.22342358475635,14.587997532278219,13.061898336942942,11.645125998750524,10.337680517700958,9.1395618937942515,8.0507701270304004,7.0713052174094129,6.2011671649312801,5.4403559695960055,4.7888716314035857,4.246714150354018,3.8138835264473139,3.4903797596834649,3.2762028500624747,3.1713527975843396,3.175829602249062,3.2896332640566421,3.5127637830070788,3.8452211591003711,4.2870053923365203,4.8381164827155336,5.4985544302373972,6.2683192349021191,7.1474108967096956,8.1358294156601314,9.2335747917534334,10.440647024989584,11.757046115368588,13.182772062890448,14.717824867555187,16.36220452936276],[63.46957893669304,59.893565082465635,56.426878085381084,53.069517945439394,49.821484662640565,46.682778236984589,43.653398668471468,40.733345957101207,37.9226201028738,35.221221105789247,32.629148965847563,30.146403683048728,27.772985257392751,25.508893688879628,23.354128977509372,21.308691123281967,19.37258012619742,17.545795986255726,15.828338703456891,14.220208277800914,12.721404709287798,11.331927997917534,10.051778143690129,8.8809551466055812,7.8194590066638856,6.8672897238650554,6.0244472982090791,5.2909317296959619,4.6667430183257013,4.15188116409829,3.7463461670137432,3.4501380270720534,3.2632567442732197,3.1857023186172424,3.217474750104123,3.3585740387338601,3.6090001845064541,3.9687531874219046,4.4378330474802121,5.0162397646813819,5.7039733390254037,6.5010337705122829,7.4074210591420178,8.42313520491461,9.5481762078300711,10.782544067888379,12.126238785089539,13.579260359433558,15.141608790920452,16.813284079550186],[62.592169024156597,59.043450796751351,55.604059426488959,52.273994913369428,49.053257257392751,45.941846458558935,42.939762516867972,40.047005432319871,37.263575204914616,34.58947183465223,32.024695321532697,29.569245665556021,27.2231228667222,24.986326925031236,22.858857840483136,20.840715613077887,18.931900242815495,17.132411729695963,15.442250073719283,13.861415274885468,12.389907333194506,11.027726248646399,9.7748720212411495,8.631344650978761,7.5971441378592255,6.67227048188255,5.856723683048731,5.1505037413577703,4.553610656809667,4.0660444294044131,3.6878050591420246,3.4188925460224899,3.259306890045814,3.2090480912119941,3.268116149521032,3.4365110649729274,3.7142328375676787,4.1012814673052853,4.5976569541857488,5.2033592982090777,5.9183884993752551,6.7427445576842944,7.6764274731361839,8.7194372457309335,9.8717738754685556,11.133437362349015,12.504427706372336,13.984744907538515,15.574388965847563,17.273359881299456],[61.723755363182001,58.202332762598914,54.790237019158681,51.487468132861302,48.294026103706791,45.209910931695127,42.235122616826317,39.369661159100374,36.613526558517286,33.966718815077051,31.429237928779674,29.001083899625154,26.682256727613495,24.472756412744687,22.372582955018746,20.381736354435652,18.50021661099542,16.728023724698044,15.065157695543521,13.511618523531864,12.067406208663058,10.732520750937113,9.5069621503540205,8.3907304069137858,7.3838255206164067,6.4862474914618904,5.6979963194502306,5.0190720045814281,4.4494745468554804,3.9892039462723856,3.6382602028321531,3.3966433165347767,3.2643532873802581,3.2413901153685951,3.3277538004997909,3.5234443427738431,3.8284617421907523,4.2428059987505158,4.7664771124531375,5.3994750832986238,6.1417999112869595,6.9934515964181534,7.9544301386922021,9.024735538109109,10.204367794668885,11.493326908371507,12.891612879216984,14.399225707205318,16.016165392336529,17.742431934610575],[60.864337953769258,57.370210980008324,53.98541086339025,50.70993760391503,47.543791201582671,44.486971656393166,41.539478968346515,38.701313137442732,35.972474163681795,33.35296204706372,30.842776787588505,28.441918385256141,26.150386840066634,23.968182152019988,21.895304321116203,19.931753347355272,18.077529230737195,16.332631971261975,14.697061568929611,13.170818023740107,11.753901335693463,10.446311504789671,9.2480485310287381,8.1591124144106626,7.1795031549354391,6.3092207526030819,5.5482652074135776,4.8966365193669317,4.3543346884631431,3.9213597147022048,3.597711598084131,3.3833903386089128,3.2783959362765511,3.2827283910870459,3.3963877030403995,3.6193738721366087,3.9516868983756752,4.3933267817575974,4.9442935222823765,5.6045871199500201,6.374207574760514,7.2531548867138653,8.2414290558100713,9.3390300820491348,10.54595796543107,11.862212705955848,13.287794303623484,14.822702758433977,16.466938070387343,18.220500239483545],[60.013916795918369,56.547085448979594,53.189580959183672,49.941403326530612,46.802552551020405,43.773028632653059,40.852831571428574,38.041961367346943,35.340418020408165,32.748201530612242,30.265311897959187,27.891749122448982,25.627513204081634,23.47260414285714,21.427021938775511,19.490766591836739,17.663838102040817,15.946236469387758,14.337961693877551,12.839013775510207,11.449392714285718,10.169098510204083,8.998131163265306,7.9364906734693887,6.9841770408163262,6.1411902653061228,5.4075303469387759,4.7831972857142873,4.2681910816326569,3.862511734693876,3.56615924489796,3.3791336122448965,3.3014348367346931,3.3330629183673453,3.4740178571428562,3.7242996530612236,4.0839083061224466,4.5528438163265257,5.1311061836734613,5.8186954081632631,6.6156114897959135,7.5218544285714239,8.5374242244897864,9.6623208775510072,10.896544387755103,12.240094755102033,13.692971979591828,15.255176061224477,16.926707,18.707564795918362],[59.17249188962932,55.732956169512697,52.402747306538942,49.181865300708033,46.070310152019992,43.068081860474798,40.175180426072465,37.391605848812993,34.717358128696375,32.152437265722611,29.696843259891711,27.350576111203662,25.113635819658477,22.986022385256142,20.967735807996672,19.058776087880052,17.259143224906293,15.568837219075386,13.987858070387336,12.516205778842151,11.153880344439818,9.9008817671803442,8.7572100470637242,7.7228651840899625,6.7978471782590564,5.9821560295710121,5.2757917380258235,4.6787543036234931,4.1910437263640183,3.8126600062473961,3.5436031432736357,3.3838731374427313,3.3334699887546848,3.3923936972094939,3.5606442628071631,3.8382216855476874,4.2251259654310678,4.7213571024573042,5.3269150966263981,6.0417999479383573,6.866011656393165,7.799550221990831,8.8424156447313518,9.9946079246147317,11.25612706164098,12.626973055810074,14.107145907122025,15.696645615576827,17.395472181174512,19.203625603915029],[58.340063234902118,54.927823141607654,51.624909905456057,48.431323526447308,45.347064004581419,42.372131339858392,39.506525532278211,36.750246581840898,34.103294488546432,31.565669252394834,29.137370873386089,26.818399351520199,24.608754686797166,22.50843687921699,20.517445928779676,18.635781835485215,16.863444599333612,15.200434220324864,13.646750698458973,12.202394033735942,10.86736422615577,9.6416612757184517,8.525285182423989,7.5182359462723864,6.6205135672636368,5.8321180453977508,5.1530493806747186,4.5833075730945456,4.1228926226572282,3.7718045293627633,3.5300432932111612,3.3976089142024151,3.3745013923365255,3.4607207276134924,3.6562669200333193,3.9611399695960006,4.3753398763015392,4.898866640149933,5.5317202611411851,6.2739007392753008,7.1254080745522659,8.086242266972091,9.1564033165347691,10.335891223240305,11.624705987088713,13.022847608079964,14.530316086214071,16.147111421491033,17.873233613910873,19.708682663473549],[57.516630831736776,54.131686365264471,50.856068755935027,47.689778003748437,44.632814108704707,41.685177070803832,38.846866890045817,36.117883566430656,33.498227099958349,30.987897490628903,28.586894738442318,26.295218843398587,24.112869805497709,22.039847624739689,20.076152301124534,18.221783834652232,16.476742225322784,14.841027473136196,13.314639578092461,11.897578540191589,10.589844359433572,9.3914370358184112,8.3023565693461059,7.3226029600166607,6.4521762078300711,5.6910763127863397,5.0393032748854649,4.4968570941274484,4.0637377705122892,3.7399453040399822,3.5254796947105378,3.4203409425239468,3.424529047480215,3.5380440095793388,3.7608858288213232,4.0930545052061635,4.5345500387338582,5.0853724294044094,5.745521677217817,6.514997782174091,7.3938007442732134,8.3819305635151977,9.4793872399000314,10.686170773427724,12.002281164098292,13.427718411911696,14.962482516867961,16.606573478967086,18.359991298209078,20.222735974593913],[56.702194680133275,53.344545840483129,50.096223857975843,46.957228732611405,43.927560464389835,41.007219053311118,38.196204499375256,35.494516802582254,32.902155962932113,30.419121980424823,28.045414855060393,25.781034586838814,23.625981175760099,21.580254621824238,19.643854925031238,17.816782085381092,16.099036102873804,14.490616977509372,12.991524709287795,11.601759298209082,10.321320744273221,9.1502090474802191,8.0884242078300712,7.1359662253227816,6.2928350999583484,5.5590308317367763,4.9345534206580606,4.4194028667222014,4.0135791699291987,3.7170823302790494,3.5299123477717615,3.4520692224073288,3.4835529541857548,3.6243635431070356,3.8745009891711777,4.2339652923781745,4.7027564527280274,5.280874470220736,5.968319344856301,6.7650910766347341,7.671189665556013,8.6866151116201511,9.8113674148271439,11.045446575176996,12.388852592669718,13.841585467305284,15.403645199083705,17.075031788004981,18.85574523406914,20.745785537276127],[55.896754780091619,52.566401567263632,49.345375211578506,46.233675713036227,43.231303071636816,40.338257287380259,37.554538360266548,34.880146290295706,32.315081077467717,29.859342721782586,27.512931223240315,25.275846581840899,23.148088797584336,21.129657870470634,19.220553800499793,17.420776587671806,15.730326231986673,14.149202733444396,12.677406092044981,11.31493630778842,10.06179338067472,8.917977310703872,7.8834880978758841,6.9583257421907536,6.1424902436484761,5.4359816022490621,4.8387998179925029,4.3509448908788011,3.9724168209079562,3.7032156080799647,3.5433412523948347,3.4927937538525606,3.5515731124531436,3.7196793281965821,3.9971124010828825,4.3838723311120358,4.879959118284046,5.4853727625989128,6.2001132640566361,7.0241806226572256,7.9575748384006628,9.0002959112869583,10.15234384131611,11.413718628488118,12.784420272802999,14.264448774260721,15.853804132861299,17.552486348604738,19.360495421491049,21.277831351520199],[55.100311131611818,51.79725354560599,48.603522816743016,45.519118945022896,42.544041930445644,39.678291773011239,36.921868472719694,34.274772029571011,31.737002443565174,29.308559714702202,26.989443842982087,24.77965482840483,22.679192670970426,20.68805737067888,18.806248927530195,17.033767341524364,15.37061261266139,13.816784740941271,12.372283726364014,11.037109568929614,9.8112622686380693,8.6947418254893787,7.6875482394835464,6.7896815106205741,6.0011416389004548,5.3219286243231974,4.7520424668887955,4.291483166597251,3.940250723448564,3.6983451374427303,3.5657664085797576,3.5425145368596413,3.6285895222823812,3.823991364847978,4.1287200645564361,4.5427756214077464,5.066158035401914,5.698867306538939,6.4409034348188188,7.2922664202415675,8.252956262807162,9.3229729625156157,10.502316519366925,11.79098693336109,13.188984204498128,14.696308332778008,16.312959318200743,18.038937160766338,19.874241860474807,21.818873417326113],[54.312863734693877,51.037101775510202,47.870666673469387,44.813558428571426,41.865777040816326,39.02732251020408,36.298194836734687,33.678394020408163,31.167920061224489,28.766772959183672,26.474952714285713,24.292459326530611,22.219292795918367,20.255453122448976,18.40094030612245,16.655754346938778,15.019895244897961,13.493363,12.076157612244897,10.768279081632654,9.5697274081632671,8.4805025918367374,7.5006046326530615,6.6300335306122449,5.8687892857142838,5.2168718979591837,4.6742813673469401,4.241017693877553,3.917080877551022,3.7024709183673461,3.5971878163265298,3.6012315714285696,3.7146021836734677,3.9372996530612205,4.2693239795918361,4.7106751632653046,5.2613532040816295,5.9213581020408101,6.6906898571428473,7.5693484693877524,8.5573339387755052,9.6546462653061145,10.861285448979581,12.177251489795903,13.602544387755099,15.137164142857138,16.781110755102031,18.534384224489781,20.39698455102041,22.368911734693871],[53.534412589337769,50.285946256976253,47.146806781757597,44.116994163681795,41.196508402748854,38.385349498958767,35.683517452311534,33.091012262807162,30.607833930445643,28.233982455226986,25.969457837151186,23.81426007621824,21.768389172428151,19.831845125780923,18.004627936276552,16.286737603915036,14.678174128696376,13.178937510620573,11.789027749687628,10.508444845897541,9.3371887992503133,8.2752596097459392,7.3226572773844225,6.4793818021657641,5.7454331840899595,5.1208114231570176,4.6055165193669296,4.1995484727197008,3.902907283215328,3.715592950853809,3.6376054756351515,3.6689448575593491,3.8096110966264041,4.0596041928363151,4.418924146189088,4.887570956684713,5.4655446243231962,6.1528451491045342,6.9494725310287304,7.855426770095792,8.8707078663057022,9.9953158196584706,11.229250630154093,12.572512297792573,14.025100822573929,15.587016204498122,17.258258443565175,19.038827539775077,20.928723493127865,22.927946303623486],[52.764957695543515,49.543786990004158,46.431943141607654,43.429426150354011,40.53623601624323,37.752372739275295,35.077836319450228,32.512626756768015,30.056744051228652,27.71018820283215,25.472959211578509,23.345057077467722,21.326481800499788,19.417233380674716,17.617311817992501,15.926717112453145,14.345449264056642,12.873508272802995,11.51089413869221,10.257606861724282,9.1136464418992098,8.0790128792169931,7.1537061736776328,6.3377263252811318,5.6310733340274854,5.0337471999167001,4.5457479229487703,4.1670755031236988,3.8977299404414829,3.7377112349021222,3.687019386505622,3.7456543952519779,3.9136162611411898,4.1909049841732582,4.5775205643481893,5.0734630016659725,5.6787322961266122,6.3933284477301084,7.2172514564764612,8.1505013223656828,9.1930780453977494,10.344981625572675,11.606212062890457,12.976769357351092,14.456653508954604,16.045864517700956,17.744402383590163,19.552267106622232,21.469458686797175,23.495977124114951],[52.004499053311115,48.810623974593916,45.726075753019572,42.750854388588088,39.884959881299459,37.128392231153683,34.481151438150768,31.94323750229071,29.51465042357351,27.195390201999164,24.985456837567678,22.88485033027905,20.89357068013328,19.01161788713036,17.238991951270307,15.575692872553104,14.021720650978761,12.577075286547274,11.24175677925864,10.015765129112872,8.8991003361099548,7.8917624002498981,6.9937513215326952,6.2050670999583506,5.5257097355268616,4.9556792282382336,4.4949755780924621,4.143598785089547,3.9015488492294885,3.7688257705122861,3.7454295489379419,3.8313601845064538,4.026617677217823,4.3312020270720488,4.7451132340691364,5.268351298209077,5.9009162194918749,6.6428079979175267,7.4940266334860377,8.4545721261974158,9.5244444760516398,10.703643683048721,11.992169747188658,13.390022668471454,14.897202446897122,16.513709082465635,18.239542575176998,20.074702925031218,22.019190132028324,24.073004196168256],[51.253036662640561,48.086457210745515,45.029204615993329,42.081278878384005,39.242679997917534,36.513407974593918,33.893462808413162,31.38284449937526,28.981553047480212,26.689588452728028,24.506950715118702,22.433639834652226,20.469655811328611,18.614998645147853,16.869668336109953,15.233664884214912,13.706988289462725,12.289638551853393,10.981615671386921,9.7829196480633058,8.69355048188255,7.713508172844648,6.8427927209496033,6.0814041261974179,5.4293423885880854,4.8866075081216156,4.4531994847980005,4.1291183186172438,3.9143640095793422,3.8089365576842966,3.8128359629321107,3.9260622253227808,4.1486153448563083,4.4804953215326906,4.9217021553519373,5.4722358463140344,6.1320963944189888,6.9012837996667997,7.7797980620574672,8.7676391815910026,9.8648071582673857,11.071301992086624,12.387123683048719,13.812272231153672,15.346747636401497,16.990549898792167,18.74367901832569,20.606134995002069,22.577917828821327,24.659027519783422],[50.510570523531854,47.371286698458974,44.34132973052894,41.420699619741768,38.609396366097457,35.907419969595992,33.314770430237395,30.831447748021656,28.457451922948767,26.192782955018739,24.037440844231568,21.991425590587252,20.054737194085796,18.227375654727194,16.509340972511453,14.900633147438567,13.401252179508537,12.011198068721363,10.73047081507705,9.5590704185755939,8.4969968792169936,7.5442501970012499,6.7008303719283617,5.9667374039983327,5.3419712932111594,4.8265320395668461,4.4204196430653884,4.123634103706789,3.9361754214910452,3.8580435964181574,3.8892386284881293,4.0297605177009572,4.2796092640566412,4.6387848675551817,5.1072873281965867,5.6851166459808411,6.3722728209079529,7.1687558529779221,8.074565742190746,9.0897024885464397,10.21416609204498,11.447956552686378,12.79107387047063,14.243518045397739,15.805289077467725,17.476386966680547,19.256811713036228,21.146563316534767,23.145641777176184,25.254047094960434],[49.777100635985001,46.665112437734273,43.662451096626405,40.769116612661392,37.985108985839233,35.310428216159934,32.745074303623483,30.289047248229902,27.942347049979176,25.704973708871304,23.576927224906289,21.558207598084131,19.648814828404831,17.848748915868384,16.158009860474806,14.576597662224074,13.104512321116204,11.741753837151188,10.488322210329027,9.3442174406497305,8.3094395281132876,7.383988472719702,6.5678642744689721,5.8610669333610987,5.2635964493960827,4.7754528225739268,4.3966360528946273,4.1271461403581844,3.9669830849645984,3.9161468867138685,3.9746375456059964,4.1424550616409803,4.4195994348188226,4.8060706651395195,5.301868752603081,5.9069936972094936,6.6214454989587637,7.4452241578508875,8.3783296738858688,9.4207620470637217,10.572521277384416,11.833607364847971,13.20402030945438,14.683760111203648,16.27282677009579,17.971220286130773,19.77894065930861,21.695987889629304,23.722361977092881,25.858062921699286],[49.052626999999994,45.967934428571425,42.99256871428571,40.126529857142849,37.369817857142856,34.722432714285709,32.184374428571424,29.755642999999999,27.436238428571425,25.226160714285712,23.125409857142856,21.133985857142857,19.251888714285712,17.479118428571425,15.815675000000001,14.26155842857143,12.816768714285715,11.481305857142855,10.255169857142857,9.1383607142857137,8.13087842857143,7.232723,6.4438944285714284,5.7643927142857141,5.1942178571428546,4.7333698571428569,4.381848714285713,4.1396544285714292,4.0067869999999992,3.9832464285714271,4.0690327142857132,4.2641458571428554,4.568585857142855,4.9823527142857094,5.5054464285714291,6.1378669999999982,6.8796144285714256,7.7306887142857077,8.6910898571428472,9.7608178571428557,10.939872714285709,12.228254428571422,13.62596299999999,15.132998428571414,16.749360714285714,18.475049857142853,20.310065857142849,22.254408714285699,24.308078428571431,26.471074999999995]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rss-3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: RSS as a function of the coefficients
</figcaption>
</figure>
</div>
</div>
<p>Our goal is to find the values of <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span> that minimize the RSS. The method of least squares provides a formula for the coefficients that minimize the RSS.</p>
<p>First, let us solve a simpler problem. Assume that the predictive equation is</p>
<p><span class="math display">
\widehat{\text{Time}}_i = \hat{\beta}_0
</span></p>
<p>The MSE in this case is much simpler.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>invoices_beta_0_dt <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta0_hat =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    invoices</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>rss_dt <span class="ot">&lt;-</span> invoices_beta_0_dt <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(beta0_hat) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">RSS =</span> <span class="fu">sum</span>((Time <span class="sc">-</span> beta0_hat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>rss_dt <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> beta0_hat, <span class="at">y =</span> RSS)) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-rss-beta0" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rss-beta0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-Least-Squares_files/figure-html/fig-rss-beta0-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rss-beta0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.5: MSE as a function of beta0_hat in an intercept-only equation
</figcaption>
</figure>
</div>
</div>
</div>
<p>How do we find the value of <span class="math inline">\hat{\beta}_0</span> that minimizes the MSE? We take the derivative of the MSE with respect to <span class="math inline">\hat{\beta}_0</span> and set it to zero.</p>
<p>In order to find the minimum of the MSE, we take the derivative of the MSE with respect to <span class="math inline">\hat{\beta}_0</span> and set it to zero. Instead of <span class="math inline">\text{Time}</span> we will use the shorter notation <span class="math inline">y_i</span> and instead of <span class="math inline">\hat{\text{Time}}_i</span> we will use the shorter notation <span class="math inline">\hat{y}_i</span>.</p>
<p><span class="math display">
\begin{align*}
RSS(\hat{\beta}_0) &amp; = \sum_{i=1}^n (y_i - \hat{y}_i)^2 \\
&amp; = \sum_{i=1}^n (y_i - \hat{\beta}_0)^2
\end{align*}
</span></p>
<p>Try to find the value of <span class="math inline">\hat{\beta}_0</span> that minimizes the MSE. <strong>Hint</strong>: Take the derivative of the RSS with respect to <span class="math inline">\hat{\beta}_0</span>, set it to zero and solve for <span class="math inline">\hat{\beta}_0</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution for the intercept-only equation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">
\begin{align*}
\frac{\partial}{\partial \hat{\beta}_0} RSS(\hat{\beta}_0) &amp; =
\sum_{i=1}^n 2(y_i - \hat{\beta}_0) \cdot (-1) \\
&amp; = -2 \sum_{i=1}^n (y_i - \hat{\beta}_0) \\
&amp; = -2 \sum_{i=1}^n y_i + 2 \sum_{i=1}^n \hat{\beta}_0 \\
&amp; = -2 \sum_{i=1}^n y_i + 2 n \hat{\beta}_0
\end{align*}
</span></p>
<p>Setting the derivative to zero, we get</p>
<p><span class="math display">
\begin{align*}
-2 \sum_{i=1}^n y_i + 2 n \hat{\beta}_0 &amp; = 0 \\
\hat{\beta}_0 &amp; = \frac{1}{n} \sum_{i=1}^n y_i \\
&amp; = \overline{y}
\end{align*}
</span></p>
<p>The value of <span class="math inline">\hat{\beta}_0</span> that minimizes the MSE is thus just the average of the observed values of <span class="math inline">y_i</span>.</p>
</div>
</div>
</div>
<div id="exr-no-intercept-equation" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.3</strong></span> Consider the following equation for the predictions</p>
<p><span class="math display">
\hat{y} = \hat{\beta}_1 x
</span></p>
<p>Find the value of <span class="math inline">\hat{\beta}_1</span> that minimizes the RSS. <strong>Hint</strong>: Take the derivative of the RSS with respect to <span class="math inline">\hat{\beta}_1</span>, set it to zero and solve for <span class="math inline">\hat{\beta}_1</span>.</p>
</div>
</section>
<section id="the-one-variable-case-with-an-intercept" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="the-one-variable-case-with-an-intercept"><span class="header-section-number">3.2</span> The one variable case with an intercept</h2>
<p>Now let us consider the case where we have two variables, <span class="math inline">\text{Invoices}_i</span> and <span class="math inline">\text{Time}_i</span>. We want to find the values of <span class="math inline">\hat{\beta}_0</span> and <span class="math inline">\hat{\beta}_1</span> that minimize the RSS.</p>
<p>The prediction equation is</p>
<p><span class="math display">
\hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1 x_i
</span></p>
<p>The RSS is (as above)</p>
<p><span class="math display">
\begin{align*}
\text{RSS}(\hat{\beta}_0, \hat{\beta}_1) &amp; = \sum_{i=1}^n (y_i - \hat{y}_i)^2 \\
  &amp; = \sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1 x_i)^2
\end{align*}
</span></p>
<p><span class="math display">
\begin{align*}
\frac{\partial}{\partial \hat{\beta}_0} \text{RSS}(\hat{\beta}_0, \hat{\beta}_1) &amp; = -2 \sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1 x_i) = 0 \\
\frac{\partial}{\partial \hat{\beta}_1} \text{RSS}(\hat{\beta}_0, \hat{\beta}_1) &amp; = -2 \sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1 x_i) x_i = 0
\end{align*}
</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The first order conditions for the minimum are</p>
<p><span class="math display">
\begin{align*}
\frac{\partial}{\partial \hat{\beta}_0} \text{RSS}(\hat{\beta}_0, \hat{\beta}_1) &amp; = -2 \sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1 x_i) = 0 \\
\frac{\partial}{\partial \hat{\beta}_1} \text{RSS}(\hat{\beta}_0, \hat{\beta}_1) &amp; = -2 \sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1 x_i) x_i = 0
\end{align*}
</span></p>
<p>The first equation gives</p>
<p><span class="math display">
\begin{align*}
\sum_{i=1}^n y_i - \hat{\beta}_0 n - \hat{\beta}_1 \sum_{i=1}^n x_i &amp; = 0 \\
\hat{\beta}_0 n + \hat{\beta}_1 \sum_{i=1}^n x_i &amp; = \sum_{i=1}^n y_i \\
\hat{\beta}_0 &amp; = \overline{y} - \hat{\beta}_1 \overline{x}
\end{align*}
</span></p>
<p>The second equation gives</p>
<p><span class="math display">
\begin{align*}
\sum_{i=1}^n y_i x_i - \hat{\beta}_0 \sum_{i=1}^n x_i - \hat{\beta}_1 \sum_{i=1}^n x_i^2 &amp; = 0 \\
\hat{\beta}_0 \sum_{i=1}^n x_i + \hat{\beta}_1 \sum_{i=1}^n x_i^2 &amp; = \sum_{i=1}^n y_i x_i \\
\hat{\beta}_0 &amp; = \overline{y} - \hat{\beta}_1 \overline{x}
\end{align*}
</span></p>
<p>Substituting the expression for <span class="math inline">\hat{\beta}_0</span> in the second equation, we get</p>
<p><span class="math display">
\begin{align*}
(\overline{y} - \hat{\beta}_1 \overline{x}) \sum_{i=1}^n x_i + \hat{\beta}_1 \sum_{i=1}^n x_i^2 &amp; = \sum_{i=1}^n y_i x_i \\
\overline{y} \sum_{i=1}^n x_i - \hat{\beta}_1 \overline{x} \sum_{i=1}^n x_i + \hat{\beta}_1 \sum_{i=1}^n x_i^2 &amp; = \sum_{i=1}^n y_i x_i \\
\hat{\beta}_1 \sum_{i=1}^n x_i^2 &amp; = \sum_{i=1}^n y_i x_i - \overline{y} \sum_{i=1}^n x_i + \hat{\beta}_1 \overline{x} \sum_{i=1}^n x_i \\
\hat{\beta}_1 &amp; = \frac{\sum_{i=1}^n y_i x_i - \overline{y} \sum_{i=1}^n x_i}{\sum_{i=1}^n x_i^2 - \overline{x} \sum_{i=1}^n x_i}
\end{align*}
</span></p>
</div>
</div>
</div>
<p>Simplifying the expression, we get</p>
<p><span class="math display">
\begin{align*}
\hat{\beta}_1 &amp; = \frac{\overline{x y} - \overline{x} \cdot \overline{y}}{\overline{x^2} - \overline{x}^2} \\
\hat{\beta}_0 &amp; = \overline{y} - \hat{\beta}_1 \overline{x}
\end{align*}
</span></p>
<p>The last expression may seem a bit complicated, but it is actually quite simple. It is just the ratio between the empirical covariance between <span class="math inline">x_i</span> and <span class="math inline">y_i</span> divided by the variance of <span class="math inline">x_i</span>.</p>
<p>The empirical covariance between <span class="math inline">x_i</span> and <span class="math inline">y_i</span> is defined as the sum of the products of the deviations of <span class="math inline">x_i</span> and <span class="math inline">y_i</span> from their respective means, divided by the number of observations.</p>
<div id="def-covariance" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.1 (Covariance)</strong></span> The covariance between two variables <span class="math inline">x</span> and <span class="math inline">y</span> with <span class="math inline">n</span> values is defined as</p>
<p><span class="math display">
S_{xy} = \frac{1}{n - 1} \sum_{i=1}^n (x_i - \overline{x})(y_i - \overline{y})
</span></p>
</div>
<div id="def-variance-decomposition" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.2 (Variance decomposition)</strong></span> We have already defined the variance of a variable <span class="math inline">x</span> as</p>
<p><span class="math display">
S_x^2 = \frac{1}{n - 1} \sum_{i=1}^n (x_i - \overline{x})^2
</span></p>
<p>It can be shown that the variance of <span class="math inline">x</span> can be decomposed into the sum of the squared mean and the variance of the deviations from the mean.</p>
<p><span class="math display">
S_x^2 = \frac{n}{n  - 1}(\overline{x_i^2} - \overline{x}^2)
</span></p>
</div>
<div class="proof callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For the proof we just write out the square in the sum and rearrange the terms.</p>
<p><span class="math display">
\begin{align*}
(n - 1) S_x^2 &amp; =  \sum_{i=1}^n (x_i - \overline{x})^2 \\
&amp; =  \sum_{i=1}^n (x_i^2 - 2x_i \overline{x} + \overline{x}^2) \\
&amp; =  \sum_{i=1}^n x_i^2 - 2\overline{x} \sum_{i=1}^n x_i + \overline{x}^2 \sum_{i=1}^n 1 \\
&amp; =  \sum_{i=1}^n x_i^2 - 2\overline{x} \sum_{i=1}^n x_i + \overline{x}^2 n \\
&amp; =  \sum_{i=1}^n x_i^2 - 2\overline{x}^2 n + \overline{x}^2 n \\
&amp; =  \sum_{i=1}^n x_i^2 - n \overline{x}^2 \\
&amp; = n (\overline{x_i^2} - \overline{x}^2)
\end{align*}
</span></p>
</div>
</div>
</div>
<div id="def-covariance" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.3 (Covariance)</strong></span> The covariance between two variables <span class="math inline">x</span> and <span class="math inline">y</span> with <span class="math inline">n</span> values is defined as</p>
<p><span class="math display">
S_{xy} = \frac{1}{n - 1} \sum_{i=1}^n (x_i - \overline{x})(y_i - \overline{y})
</span></p>
<p>Much in the same way as the variance, the covariance can be decomposed into the sum of the squared mean and the variance of the deviations from the mean.</p>
<p><span class="math display">
S_{xy} = \frac{n}{(n - 1)}(\overline{x y} - \overline{x} \overline{y})
</span></p>
<p>The proof is similar to the proof for the variance decomposition.</p>
</div>
<div class="proof callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For the proof we just write out the product in the sum and rearrange the terms.</p>
<p><span class="math display">
\begin{align*}
(n - 1) S_{xy} &amp; = \sum_{i=1}^n (x_i - \overline{x})(y_i - \overline{y}) \\
&amp; = \sum_{i=1}^n x_i y_i - \overline{x} \sum_{i=1}^n y_i - \overline{y} \sum_{i=1}^n x_i + n \overline{x} \overline{y} \\
&amp; = n(\overline{x y} - \overline{x} \overline{y})
\end{align*}
</span></p>
</div>
</div>
</div>
<p>To understand what the covariance, consider the following scatterplot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>dt_pos_cov <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">2</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>dt_pos_cov <span class="sc">%&gt;%</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(dt_pos_cov<span class="sc">$</span>x), <span class="at">colour =</span> <span class="st">"firebrick4"</span>) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(dt_pos_cov<span class="sc">$</span>y), <span class="at">colour =</span> <span class="st">"steelblue4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-covariance-positive" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-covariance-positive-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-Least-Squares_files/figure-html/fig-covariance-positive-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-covariance-positive-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.6: Scatterplot of two variables with a positive linear assocition
</figcaption>
</figure>
</div>
</div>
</div>
<p>The reddish line is drawn at the average of the <span class="math inline">x</span> values and the bluish line is drawn at the average of the <span class="math inline">y</span> values. The covariance measures the average product of the deviations of the <span class="math inline">x</span> and <span class="math inline">y</span> values from their respective means. If the product is positive, it means that when <span class="math inline">x</span> is above its average, <span class="math inline">y</span> is also above its average. If the product is negative, it means that when <span class="math inline">x</span> is above its average, <span class="math inline">y</span> is below its average.</p>
<p>You can compute the empirical covariance between two variables using the <code>cov</code> function in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(dt_pos_cov<span class="sc">$</span>x, dt_pos_cov<span class="sc">$</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.622745</code></pre>
</div>
</div>
<p>Only the <em>sign</em> of the covariance is important. The magnitude of the covariance depends on the units of the variables. To make the covariance unit-free, we can divide it by the product of the standard deviations of the two variables. This gives us the correlation coefficient.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(dt_pos_cov<span class="sc">$</span>x <span class="sc">*</span> <span class="dv">1000</span>, dt_pos_cov<span class="sc">$</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1622.745</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(dt_pos_cov<span class="sc">$</span>x , dt_pos_cov<span class="sc">$</span>y <span class="sc">*</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81.13723</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>dt_neg_cov <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">-</span><span class="dv">3</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>dt_neg_cov <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(dt_neg_cov<span class="sc">$</span>x), <span class="at">colour =</span> <span class="st">"firebrick4"</span>) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(dt_neg_cov<span class="sc">$</span>y), <span class="at">colour =</span> <span class="st">"steelblue4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-covariance-negative" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-covariance-negative-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-Least-Squares_files/figure-html/fig-covariance-negative-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-covariance-negative-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.7: Scatterplot of two variables with a positive linear assocition
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(dt_neg_cov<span class="sc">$</span>x, dt_neg_cov<span class="sc">$</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.54342</code></pre>
</div>
</div>
<div id="def-correlation" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.4 (Correlation)</strong></span> The correlation between two variables <span class="math inline">x</span> and <span class="math inline">y</span> with <span class="math inline">n</span> values is defined as</p>
<p><span class="math display">
r_{xy} = \frac{S_{xy}}{S_x S_y}
</span></p>
<p>where <span class="math inline">S_{xy}</span> is the covariance between <span class="math inline">x</span> and <span class="math inline">y</span>, and <span class="math inline">S_x</span> and <span class="math inline">S_y</span> are the standard deviations of <span class="math inline">x</span> and <span class="math inline">y</span> respectively.</p>
</div>
<p>Because the covariance is divided by the product of the standard deviations, the correlation is unit-free. Furthermore, the correlation is always between -1 and 1. A correlation of 1 means that the two variables lie on a straight line with a positive slope. A correlation of -1 means that the two variables lie on a straight line with a negative slope. A correlation of 0 means that there is no <em>linear</em> association between the two variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(dt_pos_cov<span class="sc">$</span>x, dt_pos_cov<span class="sc">$</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8786993</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(dt_neg_cov<span class="sc">$</span>x, dt_neg_cov<span class="sc">$</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9448502</code></pre>
</div>
</div>
</section>
<section id="exercise" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="exercise"><span class="header-section-number">3.3</span> Exercise</h2>
<p>Write a function that takes two vectors <code>x</code> and <code>y</code> as arguments and returns the OLS coefficients <span class="math inline">\hat{\beta}_0</span> and <span class="math inline">\hat{\beta}_1</span> using the formulas above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ols_two_variables <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the coefficients</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    beta_1_hat <span class="ot">&lt;-</span> (<span class="fu">mean</span>(x <span class="sc">*</span> y) <span class="sc">-</span> <span class="fu">mean</span>(x) <span class="sc">*</span> <span class="fu">mean</span>(y)) <span class="sc">/</span> (<span class="fu">mean</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">mean</span>(x)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    beta_0_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(y) <span class="sc">-</span> beta_1_hat <span class="sc">*</span> <span class="fu">mean</span>(x)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="at">beta_0_hat =</span> beta_0_hat, <span class="at">beta_1_hat =</span> beta_1_hat)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Test your function using the following data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>x_test <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x_test <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">ols_two_variables</span>(x_test, y_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>beta_0_hat beta_1_hat 
 0.8971969  1.9475284 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">lm</span>(y_test <span class="sc">~</span> x_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y_test ~ x_test)

Coefficients:
(Intercept)       x_test  
     0.8972       1.9475  </code></pre>
</div>
</div>
<p>Compare your results with the <code>lm</code> function in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment the following line to compare your results with the lm function</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ols_two_variables(x, y)</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y_test <span class="sc">~</span> x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y_test ~ x_test)

Coefficients:
(Intercept)       x_test  
     0.8972       1.9475  </code></pre>
</div>
</div>
</section>
<section id="ols-using-the-lm-function-in-r" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="ols-using-the-lm-function-in-r"><span class="header-section-number">3.4</span> OLS using the <code>lm</code> function in R</h2>
<p>Our primary tool for calculating the least squares coefficients will be the <code>lm</code> function in R. The <code>lm</code> function takes a formula as its first argument and a data set as its second argument. The formula is of the form <code>y ~ x</code> where <code>y</code> is the dependent variable and <code>x</code> is the independent variable. The data set is a data frame/tibble with the variables <code>x</code> and <code>y</code>.</p>
<p>Use the <code>lm</code> function to compute the OLS coefficients for the <code>invoices</code> data set. and the model:</p>
<p><span class="math display">
\widehat{\text{Time}} = \hat{\beta}_0 + \hat{\beta}_1 \text{Invoices}
</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment the following two lines to fit the model</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>fit_OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time <span class="sc">~</span> Invoices, <span class="at">data =</span> invoices)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>fit_OLS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Time ~ Invoices, data = invoices)

Coefficients:
(Intercept)     Invoices  
    0.64171      0.01129  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the predicted values for the days (observations) in the sample</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit_OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7         8 
2.3241648 1.3192085 2.7645390 0.9014177 2.9113303 1.2966252 1.5111665 3.1484549 
        9        10        11        12        13        14        15        16 
2.6854975 0.9804592 1.8837907 1.5789163 1.3192085 0.9240010 2.5951643 2.5499977 
       17        18        19        20        21        22        23        24 
2.7871223 3.2726630 3.9049950 1.1498339 2.8209972 1.4321250 3.3629961 1.8047492 
       25        26        27        28        29        30 
2.4822479 1.9967072 2.9113303 2.1660818 1.5450414 0.9691676 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the RSS for the OLS model</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>invoices <span class="ot">&lt;-</span> invoices <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">Time_predicted_OLS =</span> <span class="fu">predict</span>(fit_OLS),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">residuals_OLS =</span> Time <span class="sc">-</span> Time_predicted_OLS</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the RSS and MSE for the OLS model</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>invoices <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">RSS_OLS =</span> <span class="fu">sum</span>(residuals_OLS<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">MSE_OLS =</span> <span class="fu">mean</span>(residuals_OLS<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   RSS_OLS   MSE_OLS
1 3.045013 0.1015004</code></pre>
</div>
</div>
</section>
<section id="plot-the-ols-predictions" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="plot-the-ols-predictions"><span class="header-section-number">3.5</span> Plot the OLS predictions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the predictions</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>invoices <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Invoices, <span class="at">y =</span> Time)) <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Time_predicted_OLS), <span class="at">color =</span> <span class="st">"steelblue4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-Least-Squares_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the predictions using geom_smooth</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>invoices <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Invoices, <span class="at">y =</span> Time)) <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-Least-Squares_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-of-the-ols-coefficients" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="interpretation-of-the-ols-coefficients"><span class="header-section-number">3.6</span> Interpretation of the OLS coefficients</h2>
<ul>
<li>Scale of the coefficients</li>
<li>Interpretation of the intercept</li>
<li>Interpretation of the slope</li>
</ul>
</section>
<section id="least-squares-in-matrix-notation" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="least-squares-in-matrix-notation"><span class="header-section-number">3.7</span> Least Squares in Matrix Notation</h2>
<p>The previous discussion can be summarized in matrix notation and you will commonly find it in this form in textbooks and articles.</p>
<p>For the one variable case, the prediction equation, written for all observations is</p>
<p><span class="math display">
\begin{align*}
\hat{y}_1 &amp; = \hat{\beta}_0 + \hat{\beta}_1 x_1 \\
\hat{y}_2 &amp; = \hat{\beta}_0 + \hat{\beta}_1 x_2 \\
\vdots &amp; \\
\hat{y}_n &amp; = \hat{\beta}_0 + \hat{\beta}_1 x_n \\
\end{align*}
</span></p>
<p>This can be written in matrix notation as</p>
<p><span class="math display">
\underbrace{\begin{bmatrix}
\hat{y}_1 \\
\hat{y}_2 \\
\vdots \\
\hat{y}_n
\end{bmatrix}
}_{\hat{y}_{n \times 1}}
=
\underbrace{\begin{bmatrix}
1 &amp; x_1 \\
1 &amp; x_2 \\
\vdots &amp; \vdots \\
1 &amp; x_n
\end{bmatrix}}_{X_{n \times 2}}
\underbrace{\begin{bmatrix}
\hat{\beta}_0 \\
\hat{\beta}_1
\end{bmatrix}}_{\hat{\beta}_{2 \times 1}}
</span></p>
<p>The matrix <span class="math inline">X</span> is called the design matrix and contains the predictor terms. The vector <span class="math inline">\hat{\beta}</span> contains the coefficients that we want to estimate. The vector <span class="math inline">\hat{y}</span> contains the predicted values.</p>
<p>You can extract the design matrix from the <code>fit_OLS</code> object using the <code>model.matrix</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>fit_OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time <span class="sc">~</span> Invoices, <span class="at">data =</span> invoices)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(fit_OLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) Invoices
1            1      149
2            1       60
3            1      188
4            1       23
5            1      201
6            1       58
7            1       77
8            1      222
9            1      181
10           1       30
11           1      110
12           1       83
13           1       60
14           1       25
15           1      173
16           1      169
17           1      190
18           1      233
19           1      289
20           1       45
21           1      193
22           1       70
23           1      241
24           1      103
25           1      163
26           1      120
27           1      201
28           1      135
29           1       80
30           1       29
attr(,"assign")
[1] 0 1</code></pre>
</div>
</div>
<p>The colum of ones in the design matrix is the intercept term. The other column is the predictor term (the number of invoices in our example).</p>
<p><span class="math display">
\hat{y} = X \hat{\beta}
</span></p>
<p>You can think about the least squares as finding a solution to a system of linear equations where the number of equations is greater than the number of unknowns. Let us focus on a case with one variable and two observations (the first two from the <code>invoices</code> data set).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>invoices <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Day Invoices Time Time_hat_eq1 residuals_eq1 Time_hat_eq2 residuals_eq2
1   1      149  2.1         2.11         -0.01         2.09          0.01
2   2       60  1.8         2.11         -0.31         1.20          0.60
  Time_predicted_OLS residuals_OLS
1           2.324165    -0.2241648
2           1.319209     0.4807915</code></pre>
</div>
</div>
<p><span class="math display">
2.1 = \hat{\beta}_0 + \hat{\beta}_1 149 \\
1.8 = \hat{\beta}_0 + \hat{\beta}_1 60
</span></p>
<p>In this system of equations you have two unknowns, <span class="math inline">\hat{\beta}_0</span> and <span class="math inline">\hat{\beta}_1</span>, and two equations. Therefore, you can actually solve for the unknowns (left as an exercise).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">149</span>, <span class="dv">1</span>, <span class="dv">60</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">1.8</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(M, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.597752809 0.003370787</code></pre>
</div>
</div>
<p>You will find that the solution is <span class="math display">
\begin{align*}
\hat{\beta}_0 \approx 1.598 \\
\hat{\beta}_1 \approx 0.0034
\end{align*}
</span></p>
<p>Let’s look at the first three observations in the <code>invoices</code> data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>invoices <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Day Invoices Time Time_hat_eq1 residuals_eq1 Time_hat_eq2 residuals_eq2
1   1      149  2.1         2.11         -0.01         2.09          0.01
2   2       60  1.8         2.11         -0.31         1.20          0.60
3   3      188  2.3         2.11          0.19         2.48         -0.18
  Time_predicted_OLS residuals_OLS
1           2.324165    -0.2241648
2           1.319209     0.4807915
3           2.764539    -0.4645390</code></pre>
</div>
</div>
<p>The equations for the first three observations are</p>
<p><span class="math display">
\begin{align*}
2.1 &amp; = \hat{\beta}_0 + \hat{\beta}_1 149 \\
1.8 &amp; = \hat{\beta}_0 + \hat{\beta}_1 60 \\
2.2 &amp; = \hat{\beta}_0 + \hat{\beta}_1 201
\end{align*}
</span></p>
<p>Substituting the solution for <span class="math inline">\hat{\beta}_0</span> and <span class="math inline">\hat{\beta}_1</span> that we obtained from the first two equations into the third equation, we get</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fl">1.597752809</span> <span class="sc">+</span> <span class="fl">0.003370787</span> <span class="sc">*</span> <span class="dv">201</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.275281</code></pre>
</div>
</div>
<p>which is not exactly equal to 2.2, therefore the third equation is not satisfied.</p>
<p>In the general case we cannot hope to solve the system of equations exactly. What we could hope for is to find an approximate solution which is close to the actual left hand side values. The least squares method provides such a solution by defining a sense of <code>closeness</code> between the approximate solution and the actual left hand side values (data) and then finding the approximate solution that minimizes that <code>closeness</code> measure.</p>
</section>
<section id="the-geometry-of-least-squares" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="the-geometry-of-least-squares"><span class="header-section-number">3.8</span> The Geometry of Least Squares</h2>
<p>In the previous section we derived the formula using calculus and an objective function (the RSS) that we wanted to minimize. In this section we will derive the formula using a geometric approach.</p>
<p>First, let us think about the data in terms of vectors in a <span class="math inline">\mathbb{R}^n</span> dimensional space (where <span class="math inline">n</span> is the number of observations). For an easier visualization, let us consider the case <span class="math inline">n = 2</span> (only two observations) so that we can easily plot the data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"ggforce"</span>)) {</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"ggforce"</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Downloading packages -------------------------------------------------------
- Downloading ggforce from CRAN ...             OK [1.8 Mb in 0.55s]
- Downloading tweenr from CRAN ...              OK [449 Kb in 0.55s]
- Downloading polyclip from CRAN ...            OK [115 Kb in 0.5s]
- Downloading RcppEigen from CRAN ...           OK [1.8 Mb in 0.52s]
Successfully downloaded 4 packages in 3.6 seconds.

The following package(s) will be installed:
- ggforce   [0.4.2]
- polyclip  [1.10-6]
- RcppEigen [0.3.4.0.0]
- tweenr    [2.0.3]
These packages will be installed into "~/work/econ2024/econ2024/renv/library/R-4.3/x86_64-pc-linux-gnu".

# Installing packages --------------------------------------------------------
- Installing tweenr ...                         OK [installed binary and cached in 0.59s]
- Installing polyclip ...                       OK [installed binary and cached in 0.41s]
- Installing RcppEigen ...                      OK [installed binary and cached in 0.72s]
- Installing ggforce ...                        OK [installed binary and cached in 1.1s]
Successfully installed 4 packages in 3 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>) <span class="sc">/</span> <span class="dv">4</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.2</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>Y_proj <span class="ot">&lt;-</span> X <span class="sc">%*%</span> Y <span class="sc">/</span> X <span class="sc">%*%</span> X <span class="sc">*</span> X</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>Y_min_Y_proj <span class="ot">&lt;-</span> Y_proj <span class="sc">-</span> Y</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, Y[<span class="dv">1</span>], <span class="dv">0</span>, Y[<span class="dv">1</span>], Y[<span class="dv">2</span>], Y_proj[<span class="dv">1</span>], Y_proj[<span class="dv">1</span>]),</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, Y[<span class="dv">2</span>], <span class="dv">0</span>, X[<span class="dv">2</span>], Y[<span class="dv">2</span>], Y_proj[<span class="dv">2</span>], Y_proj[<span class="dv">2</span>]),</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">xend =</span> <span class="fu">c</span>(X[<span class="dv">1</span>], Y[<span class="dv">1</span>], Y_proj[<span class="dv">1</span>], Y_proj[<span class="dv">1</span>], <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">yend =</span> <span class="fu">c</span>(X[<span class="dv">2</span>], Y[<span class="dv">2</span>], Y_proj[<span class="dv">2</span>], Y_proj[<span class="dv">2</span>], <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">c</span>(<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> xend, <span class="at">yend =</span> yend, </span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> color</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>,<span class="st">"cm"</span>)</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"x"</span>,</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.51</span>, <span class="at">y =</span> <span class="fl">0.77</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"y_hat = bx"</span>,</span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.31</span>, <span class="at">y =</span> <span class="fl">0.6</span></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"y"</span>,</span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">1.02</span>, <span class="at">y =</span> <span class="fl">0.19</span></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"r = y - bx"</span>,</span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.76</span>, <span class="at">y =</span> <span class="fl">0.42</span></span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span></span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-vector-projection" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-vector-projection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-Least-Squares_files/figure-html/fig-vector-projection-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-vector-projection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.8: Vector projection
</figcaption>
</figure>
</div>
</div>
</div>
<p>What is the projection of the vector <span class="math inline">y</span> onto the vector <span class="math inline">x</span>? It is the vector that is closest to <span class="math inline">y</span> and lies on the line spanned by <span class="math inline">x</span>.</p>
<p>Two vectors are said to be orthogonal if their dot product is zero. The dot product of two vectors <span class="math inline">x</span> and <span class="math inline">y</span> is defined as</p>
<p><span class="math display">
x \cdot y = \sum_{i=1}^n x_i y_i
</span></p>
<p>Another way to write the dot product is as a matrix product:</p>
<p><span class="math display">
x \cdot y = x^T y
</span></p>
<p>where <span class="math inline">x^T</span> is the transpose of <span class="math inline">x</span> (meaning that <span class="math inline">x^T</span> is a row vector).</p>
<p>The least squares method can be thought of as finding the vector <span class="math inline">y_{proj}</span> that is closest to <span class="math inline">y</span> and lies on the line spanned by <span class="math inline">x</span>. The vector <span class="math inline">y - y_{proj}</span> is the vector that is orthogonal to <span class="math inline">x</span> and has the smallest length.</p>
<p>The vector <span class="math inline">y - y_{proj}</span> is called the residual vector. The length of the residual vector is the square root of the sum of the squares of its elements. This is the same as the square root of the sum of the squares of the residuals.</p>
<p>The residual vector will be smallest in length when it is orthogonal to <span class="math inline">x</span>. Therefore we can find a scalar <span class="math inline">\hat{\beta}_1</span> such that the residual vector is orthogonal to <span class="math inline">x</span>.</p>
<p>The condition that the residual vector is orthogonal to <span class="math inline">x</span> is that the dot product between the two vectors is equal to zero.</p>
<p><span class="math display">
\begin{align*}
x^T(y - \hat{\beta}_1 x) = 0 \\
x^T y - \hat{\beta}_1 x^T x = 0 \\
\hat{\beta}_1 x^T x = x^T y \\
\hat{\beta}_1 = \frac{x^T y}{x^T x}
\end{align*}
</span></p>
<p>You can rewrite the dot products as sum to see the similarity to the formulas we derived using calculus.</p>
<p><span class="math display">
\begin{align*}
x^T y = \sum_{i=1}^n x_i y_i \\
x^T x = \sum_{i=1}^n x_i^2
\end{align*}
</span></p>
<p><span class="math display">
\hat{\beta}_1 = \frac{\sum_{i=1}^n x_i y_i}{\sum_{i=1}^n x_i^2} = \frac{n \overline{x y}}{n \overline{x^2}} = \frac{\overline{x y}}{\overline{x^2}}
</span></p>
<p>In the general case of multiple variables, the projection of the outcome vector <span class="math inline">y</span> onto the space spanned by all linear combinations of the predictor variables <span class="math inline">X</span> is</p>
<p><span class="math display">
\begin{align*}
X^T(y - X \hat{\beta}) = 0 \\
X^T y - X^T X \hat{\beta} = 0 \\
X^T X \hat{\beta} = X^T y \\
\end{align*}
</span></p>
<p>In the one-variable case without an intercept term, we could devide the equation by <span class="math inline">x^T x</span> to get the formula for <span class="math inline">\hat{\beta}_1</span>. This worked because the scalar product of a vector is a scalar. However, here we need to deal with a whole matrix (<span class="math inline">X^TX</span>). We can solve the equation for <span class="math inline">\hat{\beta}</span> by pre-multiplying both sides by the inverse of <span class="math inline">X^T X</span>.</p>
<p><span class="math display">
\begin{align*}
\hat{\beta} &amp; = (X^T X)^{-1} X^T y
\end{align*}
</span></p>
<p>The last operation requires that inverse of <span class="math inline">X^T X</span> exists. This is the case if the columns of <span class="math inline">X</span> are linearly independent. If some of the columns of <span class="math inline">X</span> are linearly dependent, the matrix <span class="math inline">X^T X</span> will be singular and its inverse will not exist.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create t full column rank matrix</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>x_fcr <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">149</span>, <span class="dv">1</span>, <span class="dv">60</span>, <span class="dv">1</span>, <span class="dv">201</span>),</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>x_fcr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1  149
[2,]    1   60
[3,]    1  201</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the inverse of the matrix. The %*% operator is the matrix multiplication operator in R</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(x_fcr) <span class="sc">%*%</span> x_fcr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]          [,2]
[1,]  2.17013047 -1.343998e-02
[2,] -0.01343998  9.834131e-05</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To veritfy that the inverse is correct, multiply the matrix with its inverse</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(x_fcr) <span class="sc">%*%</span> x_fcr <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">t</span>(x_fcr) <span class="sc">%*%</span> x_fcr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              [,1]          [,2]
[1,]  1.000000e+00 -4.282599e-18
[2,] -1.344411e-13  1.000000e+00</code></pre>
</div>
</div>
<p>What happens if we have a matrix that is not full column rank?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>x_rcr <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">149</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">60</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">149</span>, <span class="dv">2</span>),</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>x_rcr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1  149    2
[2,]    1   60    2
[3,]    1  149    2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># solve(t(x_rcr) %*% x_rcr)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the case of a matrix that is not full column rank, the inverse of the matrix does not exist, and <code>solve</code> will throw an error. We say that there is (perfect) multicollinearity in predictors.</p>
<p>The same will happen if some column is a linear combination (e.g.&nbsp;the sum) of some other columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>x_rcr1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x_fcr, <span class="fl">0.2</span> <span class="sc">*</span> x_fcr[, <span class="dv">1</span>] <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> x_fcr[, <span class="dv">2</span>])</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>x_rcr1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]   [,3]
[1,]    1  149  745.2
[2,]    1   60  300.2
[3,]    1  201 1005.2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># solve(t(x_rcr1) %*% x_rcr1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-Descriptive-Statistics.html" class="pagination-link" aria-label="Descriptive Statistics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Descriptive Statistics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04a-Discrete-Distributions.html" class="pagination-link" aria-label="Discrete Distributions (Review)">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Discrete Distributions (Review)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>